<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>GraphQL Server Specification · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The goal of this document is to specify the assumptions that Relay makes about a GraphQL server and demonstrate them through an example GraphQL schema."/><meta name="docsearch:version" content="v1.4.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="GraphQL Server Specification · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://relay.dev/"/><meta property="og:description" content="The goal of this document is to specify the assumptions that Relay makes about a GraphQL server and demonstrate them through an example GraphQL schema."/><meta property="og:image" content="https://relay.dev/img/relay.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://relay.dev/img/relay.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-50', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="/js/redirect.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><h2 class="headerTitle">Relay</h2></a><a href="/en/versions"><h3>v1.4.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/en/v1.4.1/introduction-to-relay" target="_self">Docs</a></li><li class=""><a href="/en/help" target="_self">Help</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/introduction-to-relay">Introduction to Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/installation-and-setup">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/quick-start-guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/graphql-in-relay">GraphQL in Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-environment">Relay Environment</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/network-layer">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/query-renderer">QueryRenderer</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/fragment-container">Fragment Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/refetch-container">Refetch Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/pagination-container">Pagination Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/mutations">Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/subscriptions">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-store">Relay Store</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/routing">Routing</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-debugging">Debugging</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/v1.4.1/graphql-server-specification">GraphQL Server Specification</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Migration Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/new-in-relay-modern">New in Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-compat">Compatibility Mode</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/migration-setup">Migration Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/conversion-playbook">Conversion Playbook</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/conversion-scripts">Conversion Scripts</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/upgrading-setvariables">Upgrading setVariables</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/converting-mutations">Converting Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/compatibility-cheatsheet">Compatibility Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/api-cheatsheet">API Cheatsheet</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Principles &amp; Architecture<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/thinking-in-graphql">Thinking in GraphQL</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/thinking-in-relay">Thinking In Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/architecture-overview">Architecture Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/compiler-architecture">Compiler Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/runtime-architecture">Runtime Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/videos">Videos</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/relay/edit/master/docs/GraphQL-ServerSpecification.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">GraphQL Server Specification</h1></header><article><div><span><p>The goal of this document is to specify the assumptions that Relay makes about a GraphQL server and demonstrate them through an example GraphQL schema.</p>
<p>Table of Contents:</p>
<ul>
<li><a href="#preface">Preface</a></li>
<li><a href="#schema">Schema</a></li>
<li><a href="#object-identification">Object Identification</a></li>
<li><a href="#connections">Connections</a></li>
<li><a href="#mutations">Mutations</a></li>
<li><a href="#further-reading">Further Reading</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="preface"></a><a href="#preface" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Preface</h2>
<p>The three core assumptions that Relay makes about a GraphQL server are that it provides:</p>
<ol>
<li>A mechanism for refetching an object.</li>
<li>A description of how to page through connections.</li>
<li>Structure around mutations to make them predictable.</li>
</ol>
<p>This example demonstrates all three of these assumptions. This example is not comprehensive, but it is designed to quickly introduce these core assumptions, to provide some context before diving into the more detailed specification of the library.</p>
<p>The premise of the example is that we want to use GraphQL to query for information about ships and factions in the original Star Wars trilogy.</p>
<p>It is assumed that the reader is already familiar with <a href="http://graphql.org/">GraphQL</a>; if not, the README for <a href="https://github.com/graphql/graphql-js">GraphQL.js</a> is a good place to start.</p>
<p>It is also assumed that the reader is already familiar with <a href="https://en.wikipedia.org/wiki/Star_Wars">Star Wars</a>; if not, the 1977 version of Star Wars is a good place to start, though the 1997 Special Edition will serve for the purposes of this document.</p>
<h2><a class="anchor" aria-hidden="true" id="schema"></a><a href="#schema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Schema</h2>
<p>The schema described below will be used to demonstrate the functionality that a GraphQL server used by Relay should implement. The two core types are a faction and a ship in the Star Wars universe, where a faction has many ships associated with it. The schema below is the output of the GraphQL.js <a href="https://github.com/graphql/graphql-js/blob/master/src/utilities/schemaPrinter.js"><code>schemaPrinter</code></a>.</p>
<pre><code class="hljs"><span class="hljs-title">interface</span> <span class="hljs-type">Node</span> {
  id: <span class="hljs-type">ID</span>!
}

<span class="hljs-keyword">type</span> <span class="hljs-type">Faction</span> : <span class="hljs-type">Node</span> {
  id: <span class="hljs-type">ID</span>!
  name: <span class="hljs-type">String</span>
  ships: <span class="hljs-type">ShipConnection</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-type">Ship</span> : <span class="hljs-type">Node</span> {
  id: <span class="hljs-type">ID</span>!
  name: <span class="hljs-type">String</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-type">ShipConnection</span> {
  edges: [<span class="hljs-type">ShipEdge</span>]
  pageInfo: <span class="hljs-type">PageInfo</span>!
}

<span class="hljs-keyword">type</span> <span class="hljs-type">ShipEdge</span> {
  cursor: <span class="hljs-type">String</span>!
  node: <span class="hljs-type">Ship</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-type">PageInfo</span> {
  hasNextPage: <span class="hljs-type">Boolean</span>!
  hasPreviousPage: <span class="hljs-type">Boolean</span>!
  startCursor: <span class="hljs-type">String</span>
  endCursor: <span class="hljs-type">String</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-type">Query</span> {
  rebels: <span class="hljs-type">Faction</span>
  empire: <span class="hljs-type">Faction</span>
  node(id: <span class="hljs-type">ID</span>!): <span class="hljs-type">Node</span>
}

<span class="hljs-title">input</span> <span class="hljs-type">IntroduceShipInput</span> {
  factionId: <span class="hljs-type">String</span>!
  shipNamed: <span class="hljs-type">String</span>!
  clientMutationId: <span class="hljs-type">String</span>!
}

<span class="hljs-keyword">type</span> <span class="hljs-type">IntroduceShipPayload</span> {
  faction: <span class="hljs-type">Faction</span>
  ship: <span class="hljs-type">Ship</span>
  clientMutationId: <span class="hljs-type">String</span>!
}

<span class="hljs-keyword">type</span> <span class="hljs-type">Mutation</span> {
  introduceShip(input: <span class="hljs-type">IntroduceShipInput</span>!): <span class="hljs-type">IntroduceShipPayload</span>
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="object-identification"></a><a href="#object-identification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Object Identification</h2>
<p>Both <code>Faction</code> and <code>Ship</code> have identifiers that we can use to refetch them. We expose this capability to Relay through the <code>Node</code> interface and the <code>node</code> field on the root query type.</p>
<p>The <code>Node</code> interface contains a single field, <code>id</code>, which is a <code>ID!</code>. The <code>node</code> root field takes a single argument, a <code>ID!</code>, and returns a <code>Node</code>. These two work in concert to allow refetching; if we pass the <code>id</code> returned in that field to the <code>node</code> field, we get the object back.</p>
<p>Let's see this in action, and query for the ID of the rebels:</p>
<pre><code class="hljs"><span class="hljs-attribute">query</span> RebelsQuery {
  <span class="hljs-section">rebels</span> {
    <span class="hljs-attribute">id</span>
    name
  }
}
</code></pre>
<p>returns</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;RmFjdGlvbjox&quot;</span>,
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>
  }
}
</code></pre>
<p>So now we know the ID of the Rebels in our system. We can now refetch them:</p>
<pre><code class="hljs">query RebelsRefetchQuery {
  node(<span class="hljs-built_in">id</span>: <span class="hljs-string">&quot;RmFjdGlvbjox&quot;</span>) {
    <span class="hljs-built_in">id</span>
    ... <span class="hljs-keyword">on</span> Faction {
      <span class="hljs-built_in">name</span>
    }
  }
}
</code></pre>
<p>returns</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;node&quot;</span>: {
    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;RmFjdGlvbjox&quot;</span>,
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>
  }
}
</code></pre>
<p>If we do the same thing with the Empire, we'll find that it returns a different ID, and we can refetch it as well:</p>
<pre><code class="hljs"><span class="hljs-attribute">query</span> EmpireQuery {
  <span class="hljs-section">empire</span> {
    <span class="hljs-attribute">id</span>
    name
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;empire&quot;</span>: {
    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;RmFjdGlvbjoy&quot;</span>,
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Galactic Empire&quot;</span>
  }
}
</code></pre>
<p>and</p>
<pre><code class="hljs">query EmpireRefetchQuery {
  node(<span class="hljs-built_in">id</span>: <span class="hljs-string">&quot;RmFjdGlvbjoy&quot;</span>) {
    <span class="hljs-built_in">id</span>
    ... <span class="hljs-keyword">on</span> Faction {
      <span class="hljs-built_in">name</span>
    }
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;node&quot;</span>: {
    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;RmFjdGlvbjoy&quot;</span>,
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Galactic Empire&quot;</span>
  }
}
</code></pre>
<p>The <code>Node</code> interface and <code>node</code> field assume globally unique IDs for this refetching. A system without globally unique IDs can usually synthesize them by combining the type with the type-specific ID, which is what was done in this example.</p>
<p>The IDs we got back were base64 strings. IDs are designed to be opaque (the only thing that should be passed to the <code>id</code> argument on <code>node</code> is the unaltered result of querying <code>id</code> on some object in the system), and base64ing a string is a useful convention in GraphQL to remind viewers that the string is an opaque identifier.</p>
<p>Complete details on how the server should behave are available in the <a href="/graphql/objectidentification.htm">GraphQL Object Identification</a> spec.</p>
<h2><a class="anchor" aria-hidden="true" id="connections"></a><a href="#connections" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Connections</h2>
<p>A faction has many ships in the Star Wars universe. Relay contains functionality to make manipulating one-to-many relationships easy, using a standardized way of expressing these one-to-many relationships. This standard connection model offers ways of slicing and paginating through the connection.</p>
<p>Let's take the rebels, and ask for their first ship:</p>
<pre><code class="hljs">query RebelsShipsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">1</span>) {
      edges {
        <span class="hljs-keyword">node</span> <span class="hljs-title">{
          name</span>
        }
      }
    }
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>,
    <span class="hljs-attr">&quot;ships&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: [
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;X-Wing&quot;</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>That used the <code>first</code> argument to <code>ships</code> to slice the result set down to the first one. But what if we wanted to paginate through it? On each edge, a cursor will be exposed that we can use to paginate. Let's ask for the first two this time, and get the cursor as well:</p>
<pre><code class="hljs">query MoreRebelShipsQuery {
  rebels {
    name,
    ships(first: <span class="hljs-number">2</span>) {
      edges {
        cursor
        <span class="hljs-keyword">node</span> <span class="hljs-title">{
          name</span>
        }
      }
    }
  }
}
</code></pre>
<p>and we get back</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>,
    <span class="hljs-attr">&quot;ships&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: [
        {
          <span class="hljs-attr">&quot;cursor&quot;</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjA=&quot;</span>,
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;X-Wing&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;cursor&quot;</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjE=&quot;</span>,
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Y-Wing&quot;</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>Notice that the cursor is a base64 string. That's the pattern from earlier: the server is reminding us that this is an opaque string. We can pass this string back to the server as the <code>after</code> argument to the <code>ships</code> field, which will let us ask for the next three ships after the last one in the previous result:</p>
<pre><code class="hljs">query EndOfRebelShipsQuery {
  rebels {
    <span class="hljs-built_in">name</span>,
    ships(<span class="hljs-keyword">first</span>: <span class="hljs-number">3</span> <span class="hljs-keyword">after</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjE=&quot;</span>) {
      edges {
        cursor,
        node {
          <span class="hljs-built_in">name</span>
        }
      }
    }
  }
}
</code></pre>
<p>gives us</p>
<pre><code class="hljs css language-json">
{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>,
    <span class="hljs-attr">&quot;ships&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: [
        {
          <span class="hljs-attr">&quot;cursor&quot;</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjI=&quot;</span>,
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;A-Wing&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;cursor&quot;</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjM=&quot;</span>,
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Millenium Falcon&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;cursor&quot;</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjQ=&quot;</span>,
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Home One&quot;</span>
          }
        }
      ]
    }
  }
}
</code></pre>
<p>Sweet! Let's keep going and get the next four!</p>
<pre><code class="hljs">query RebelsQuery {
  rebels {
    <span class="hljs-built_in">name</span>,
    ships(<span class="hljs-keyword">first</span>: <span class="hljs-number">4</span> <span class="hljs-keyword">after</span>: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjQ=&quot;</span>) {
      edges {
        cursor,
        node {
          <span class="hljs-built_in">name</span>
        }
      }
    }
  }
}
</code></pre>
<p>yields</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>,
    <span class="hljs-attr">&quot;ships&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: []
    }
  }
}
</code></pre>
<p>Hm. There were no more ships; guess there were only five in the system for the rebels. It would have been nice to know that we'd reached the end of the connection, without having to do another round trip in order to verify that. The connection model exposes this capability with a type called <code>PageInfo</code>. So let's issue the two queries that got us ships again, but this time ask for <code>hasNextPage</code>:</p>
<pre><code class="hljs">query <span class="hljs-class">EndOfRebelShipsQuery </span>{
  <span class="hljs-class">rebels </span>{
    name,
<span class="hljs-symbol">    originalShips:</span> ships(first: <span class="hljs-number">2</span>) {
      <span class="hljs-class">edges </span>{
        <span class="hljs-class">node </span>{
          name
        }
      }
      <span class="hljs-class">pageInfo </span>{
        hasNextPage
      }
    }
<span class="hljs-symbol">    moreShips:</span> ships(first: <span class="hljs-number">3</span> after: <span class="hljs-string">&quot;YXJyYXljb25uZWN0aW9uOjE=&quot;</span>) {
      <span class="hljs-class">edges </span>{
        <span class="hljs-class">node </span>{
          name
        }
      }
      <span class="hljs-class">pageInfo </span>{
        hasNextPage
      }
    }
  }
}
</code></pre>
<p>and we get back</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;rebels&quot;</span>: {
    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>,
    <span class="hljs-attr">&quot;originalShips&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: [
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;X-Wing&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Y-Wing&quot;</span>
          }
        }
      ],
      <span class="hljs-attr">&quot;pageInfo&quot;</span>: {
        <span class="hljs-attr">&quot;hasNextPage&quot;</span>: <span class="hljs-literal">true</span>
      }
    },
    <span class="hljs-attr">&quot;moreShips&quot;</span>: {
      <span class="hljs-attr">&quot;edges&quot;</span>: [
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;A-Wing&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Millenium Falcon&quot;</span>
          }
        },
        {
          <span class="hljs-attr">&quot;node&quot;</span>: {
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Home One&quot;</span>
          }
        }
      ],
      <span class="hljs-attr">&quot;pageInfo&quot;</span>: {
        <span class="hljs-attr">&quot;hasNextPage&quot;</span>: <span class="hljs-literal">false</span>
      }
    }
  }
}
</code></pre>
<p>So on the first query for ships, GraphQL told us there was a next page, but on the next one, it told us we'd reached the end of the connection.</p>
<p>Relay uses all of this functionality to build out abstractions around connections, to make these easy to work with efficiently without having to manually manage cursors on the client.</p>
<p>Complete details on how the server should behave are available in the <a href="/graphql/connections.htm">GraphQL Cursor Connections</a> spec.</p>
<h2><a class="anchor" aria-hidden="true" id="mutations"></a><a href="#mutations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mutations</h2>
<p>Relay uses a common pattern for mutations, where they are root fields on the mutation type with a single argument, <code>input</code>, and where the input and output both contain a client mutation identifier used to reconcile requests and responses.</p>
<p>By convention, mutations are named as verbs, their inputs are the name with &quot;Input&quot; appended at the end, and they return an object that is the name with &quot;Payload&quot; appended.</p>
<p>So for our <code>introduceShip</code> mutation, we create two types: <code>IntroduceShipInput</code> and <code>IntroduceShipPayload</code>:</p>
<pre><code class="hljs"><span class="hljs-selector-tag">input</span> <span class="hljs-selector-tag">IntroduceShipInput</span> {
  <span class="hljs-attribute">factionId</span>: ID!
  shipName: String!
  clientMutationId: String!
}

<span class="hljs-selector-tag">type</span> <span class="hljs-selector-tag">IntroduceShipPayload</span> {
  <span class="hljs-attribute">faction</span>: Faction
  ship: Ship
  clientMutationId: String!
}
</code></pre>
<p>With this input and payload, we can issue the following mutation:</p>
<pre><code class="hljs">mutation AddBWingQuery(<span class="hljs-variable">$input</span>: IntroduceShipInput!) {
  introduceShip(input: <span class="hljs-variable">$input</span>) {
    <span class="hljs-keyword">ship</span> {
      <span class="hljs-built_in">id</span>
      <span class="hljs-literal">name</span>
    }
    <span class="hljs-keyword">faction</span> {
      <span class="hljs-literal">name</span>
    }
    <span class="hljs-keyword">clientMutationId</span>
  }
}
</code></pre>
<p>with these params:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;input&quot;</span>: {
    <span class="hljs-attr">&quot;shipName&quot;</span>: <span class="hljs-string">&quot;B-Wing&quot;</span>,
    <span class="hljs-attr">&quot;factionId&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
    <span class="hljs-attr">&quot;clientMutationId&quot;</span>: <span class="hljs-string">&quot;abcde&quot;</span>
  }
}
</code></pre>
<p>and we'll get this result:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">&quot;introduceShip&quot;</span>: {
    <span class="hljs-attr">&quot;ship&quot;</span>: {
      <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;U2hpcDo5&quot;</span>,
      <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;B-Wing&quot;</span>
    },
    <span class="hljs-attr">&quot;faction&quot;</span>: {
      <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Alliance to Restore the Republic&quot;</span>
    },
    <span class="hljs-attr">&quot;clientMutationId&quot;</span>: <span class="hljs-string">&quot;abcde&quot;</span>
  }
}
</code></pre>
<p>Complete details on how the server should behave are available in the <a href="/graphql/mutations.htm">GraphQL Input Object Mutations</a> spec.</p>
<h2><a class="anchor" aria-hidden="true" id="further-reading"></a><a href="#further-reading" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Further Reading</h2>
<p>This concludes the overview of the GraphQL Server Specifications. For the detailed requirements of a Relay-compliant GraphQL server, a more formal description of the <a href="/graphql/connections.htm">Relay cursor connection</a> model, the <a href="/graphql/objectidentification.htm">Relay global object identification</a> model, and the <a href="/graphql/mutations.htm">Relay input object mutation</a> are all available.</p>
<p>To see code implementing the specification, the <a href="https://github.com/graphql/graphql-relay-js">GraphQL.js Relay library</a> provides helper functions for creating nodes, connections, and mutations; that repository's <a href="https://github.com/graphql/graphql-relay-js/tree/master/src/__tests__"><code>__tests__</code></a> folder contains an implementation of the above example as integration tests for the repository.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 8/4/2019 by Yangshun Tay</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/v1.4.1/relay-debugging"><span class="arrow-prev">← </span><span>Debugging</span></a><a class="docs-next button" href="/docs/en/v1.4.1/new-in-relay-modern"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#preface">Preface</a></li><li><a href="#schema">Schema</a></li><li><a href="#object-identification">Object Identification</a></li><li><a href="#connections">Connections</a></li><li><a href="#mutations">Mutations</a></li><li><a href="#further-reading">Further Reading</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/relay.svg" alt="Relay" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/introduction-to-relay.html">Introduction</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a></div><div><h5>More</h5><a href="https://github.com/facebook/relay">GitHub</a><a href="https://opensource.facebook.com/legal/terms">Terms of Use</a><a href="https://opensource.facebook.com/legal/privacy">Privacy Policy</a><a href="https://opensource.facebook.com/legal/data-policy/">Data Policy</a><a href="https://opensource.facebook.com/legal/cookie-policy/">Cookie Policy</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2021 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '3d7d5825d50ea36bca0e6ad06c926f06',
                indexName: 'relay',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:v1.4.1"]}
              });
            </script></body></html>