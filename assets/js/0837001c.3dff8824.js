"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["51154"],{15912(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>u,frontMatter:()=>o,contentTitle:()=>i,toc:()=>d,assets:()=>l});var r=JSON.parse('{"id":"guides/codemods","title":"Codemods","description":"Relay guide to codemods","source":"@site/versioned_docs/version-v20.0.0/guides/codemods.md","sourceDirName":"guides","slug":"/guides/codemods/","permalink":"/docs/v20.0.0/guides/codemods/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v20.0.0/guides/codemods.md","tags":[],"version":"v20.0.0","frontMatter":{"id":"codemods","title":"Codemods","slug":"/guides/codemods/","description":"Relay guide to codemods","keywords":["codemod","codemods"]},"sidebar":"docs","previous":{"title":"Type Emission","permalink":"/docs/v20.0.0/guides/type-emission/"},"next":{"title":"RelayEnvironmentProvider","permalink":"/docs/v20.0.0/api-reference/relay-environment-provider/"}}'),a=t(74848),s=t(28453);t(86898),t(17352),t(78010),t(57250);let o={id:"codemods",title:"Codemods",slug:"/guides/codemods/",description:"Relay guide to codemods",keywords:["codemod","codemods"]},i,l={},d=[{value:"Available codemods",id:"available-codemods",level:2},{value:"mark-dangerous-conditional-fragment-spreads",id:"mark-dangerous-conditional-fragment-spreads",level:3},{value:"remove-unnecessary-required-directives",id:"remove-unnecessary-required-directives",level:3}];function c(e){let n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["The Relay compiler has the ability to make changes across the source files of\nyour projects with the use of codemods. You can see the list of codemods\navailable by running the Relay compiler's ",(0,a.jsx)(n.code,{children:"codemod"})," command:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"> relay codemod --help\nApply codemod (verification with auto-applied fixes)\n\nUsage: relay codemod [OPTIONS] [CONFIG] <COMMAND>\n\nCommands:\n  mark-dangerous-conditional-fragment-spreads  Marks unaliased conditional fragment spreads as @dangerously_unaliased_fixme\n  help                                         Print this message or the help of the given subcommand(s)\n\nArguments:\n  [CONFIG]  Compile using this config file. If not provided, searches for a config in package.json under the `relay` key or `relay.config.json` files among other up from the current working directory\n\nOptions:\n  -p, --project <project>  Compile only this project. You can pass this argument multiple times. to compile multiple projects. If excluded, all projects will be compiled\n  -h, --help               Print help\n"})}),"\n",(0,a.jsx)(n.h2,{id:"available-codemods",children:"Available codemods"}),"\n",(0,a.jsx)(n.p,{children:"The compiler currently has these available codemods:"}),"\n",(0,a.jsx)(n.h3,{id:"mark-dangerous-conditional-fragment-spreads",children:"mark-dangerous-conditional-fragment-spreads"}),"\n",(0,a.jsxs)(n.p,{children:["This codemod finds fragment spreads that are ",(0,a.jsx)(n.em,{children:"dangerously unaliased"}),"; that is,\nthe fragment might not be fetched due to a directive such as ",(0,a.jsx)(n.code,{children:"@skip"})," or its\ninclusion on a mismatched type within a union. If such a conditional fragment is\nnot aliased with ",(0,a.jsx)(n.a,{href:"../alias-directive/",children:(0,a.jsx)(n.code,{children:"@alias"})}),", there is no way for the\nresulting generated Flow or TypeScript types to reflect its nullability. This\ncodemod will add the ",(0,a.jsx)(n.code,{children:"@dangerously_unaliased_fixme"})," directive to such fragment\nspreads, indicating to developers that there is a problem to be fixed. After\napplying this codemod, the ",(0,a.jsx)(n.code,{children:"enforce_fragment_alias_where_ambiguous"})," feature flag\ncan be enabled, which will ensure any future ambiguous fragment spreads must be\naliased."]}),"\n",(0,a.jsxs)(n.p,{children:["Since this codemod can potentially modify many files, there is an optional\n",(0,a.jsx)(n.code,{children:"--rollout"})," parameter which, if used alongside the\n",(0,a.jsx)(n.code,{children:"enforce_fragment_alias_where_ambiguous"})," feature flag in rollout mode, allows\nprogressive codemod and enforcement of this validation."]}),"\n",(0,a.jsx)(n.h3,{id:"remove-unnecessary-required-directives",children:"remove-unnecessary-required-directives"}),"\n",(0,a.jsxs)(n.p,{children:["Removes ",(0,a.jsx)(n.a,{href:"/docs/v20.0.0/api-reference/graphql-and-directives/#required",children:"@required"}),"\ndirectives from non-null fields within\n",(0,a.jsx)(n.a,{href:"/docs/v20.0.0/api-reference/graphql-and-directives/#throwonfielderror",children:"@throwOnFieldError"}),"\nfragments and operations, or linked fields with\n",(0,a.jsx)(n.a,{href:"/docs/v20.0.0/guides/catch-directive/",children:(0,a.jsx)(n.code,{children:"@catch"})}),", where the compiler is certain that the\ndirective does not change the generated types for the data being fetched."]})]})}function u(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},57250(e,n,t){t.r(n),t.d(n,{default:()=>s});var r=t(74848);t(96540);var a=t(18215);function s({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)("tabItem_Ymn6",t),hidden:n,children:e})}},78010(e,n,t){t.r(n),t.d(n,{default:()=>x});var r=t(74848),a=t(96540),s=t(18215),o=t(88287),i=t(28584),l=t(99770),d=t(99989),c=t(96629),u=t(80618),h=t(41367);function m(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}var f=t(19863);function v({className:e,block:n,selectedValue:t,selectValue:a,tabValues:o}){let l=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.a_)(),c=e=>{let n=e.currentTarget,r=o[l.indexOf(n)].value;r!==t&&(d(n),a(r))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{let t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{let t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1]}}n?.focus()};return(0,r.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:o.map(({value:e,label:n,attributes:a})=>(0,r.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{l.push(e)},onKeyDown:u,onClick:c,...a,className:(0,s.A)("tabs__item","tabItem_LNqP",a?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function g({lazy:e,children:n,selectedValue:t}){let o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=o.find(e=>e.props.value===t);return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,r.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function b(e){let n=function(e){let n,{defaultValue:t,queryString:r=!1,groupId:s}=e,o=function(e){let{values:n,children:t}=e;return(0,a.useMemo)(()=>{let e=n??m(t).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r})),r=(0,u.XI)(e,(e,n)=>e.value===n.value);if(r.length>0)throw Error(`Docusaurus error: Duplicate values "${r.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,t])}(e),[i,f]=(0,a.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let t=n.find(e=>e.default)??n[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:t,tabValues:o})),[v,g]=function({queryString:e=!1,groupId:n}){let t=(0,l.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(r),(0,a.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}({queryString:r,groupId:s}),[b,x]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[t,r]=(0,h.Dv)(n);return[t,(0,a.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:s}),w=p({value:n=v??b,tabValues:o})?n:null;return(0,d.A)(()=>{w&&f(w)},[w]),{selectedValue:i,selectValue:(0,a.useCallback)(e=>{if(!p({value:e,tabValues:o}))throw Error(`Can't select invalid tab value=${e}`);f(e),g(e),x(e)},[g,x,o]),tabValues:o}}(e);return(0,r.jsxs)("div",{className:(0,s.A)(o.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,r.jsx)(v,{...n,...e}),(0,r.jsx)(g,{...n,...e})]})}function x(e){let n=(0,f.default)();return(0,r.jsx)(b,{...e,children:m(e.children)},String(n))}},86898(e,n,t){t.d(n,{A:()=>p});var r=t(74848),a=t(95310),s=t(17352),o=t(96540);function i(){let e=window.encodeURI(JSON.stringify({title:"Feedback about "+window.location.pathname,description:"**!!! Required !!!**\n\nPlease modify the task description to let us know how the docs can be improved.\n\n**Please do not ask support questions via this form! Instead, ask in fburl.com/relay_support**",tag_ids:{add:[0xac96423e5b680,0x64079768ac750]}}));window.open("https://www.internalfb.com/tasks/?n="+e)}function l({children:e}){return(0,r.jsxs)("div",{className:"docsRating",id:"docsRating",children:[(0,r.jsx)("hr",{}),e]})}let d=()=>{let[e,n]=o.useState(!1),t=e=>{n(!0),window.ga&&window.ga("send",{hitType:"event",eventCategory:"button",eventAction:"feedback",eventValue:e})};return e?"Thank you for letting us know!":(0,r.jsxs)(r.Fragment,{children:["Is this page useful?",(0,r.jsx)("svg",{className:"i_thumbsup",alt:"Like",id:"docsRating-like",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>t(1),children:(0,r.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})}),(0,r.jsx)("svg",{className:"i_thumbsdown",alt:"Dislike",id:"docsRating-dislike",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>t(0),children:(0,r.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})})]})},c=()=>(0,r.jsxs)("p",{children:["Let us know how these docs can be improved by",(0,r.jsx)("a",{className:"button",role:"button",tabIndex:0,onClick:i,children:"Filing a task"})]}),u=()=>(0,r.jsxs)("p",{children:["Help us make the site even better by"," ",(0,r.jsx)(a.default,{to:"https://www.surveymonkey.com/r/FYC9TCJ",children:"answering a few quick questions"}),"."]}),h=()=>(0,r.jsxs)(l,{children:[(0,r.jsx)(c,{}),(0,r.jsx)(d,{}),(0,r.jsx)(u,{})]}),m=()=>(0,r.jsxs)(l,{children:[(0,r.jsx)(d,{}),(0,r.jsx)(u,{})]}),p=()=>(0,s.fbContent)({internal:(0,r.jsx)(h,{}),external:(0,r.jsx)(m,{})})},28453(e,n,t){t.d(n,{R:()=>o,x:()=>i});var r=t(96540);let a={},s=r.createContext(a);function o(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);