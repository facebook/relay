<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>FragmentContainer - Relay Docs</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="FragmentContainer - Relay Docs"><meta property="og:type" content="website"><meta property="og:url" content="http://facebook.github.io/relay/"><meta property="og:description" content="A JavaScript framework for building data-driven React applications"><link rel="shortcut icon" href="/relay/img/favicon.png"><link rel="stylesheet" href="/relay/css/relay.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/relay/"><img class="nav-logo" src="/relay/img/logo.svg" width="50" height="50">Relay</a><ul class="nav-site"><li><a href="/relay/prototyping/playground.html" class="">Try it out</a></li><li><a href="/relay/docs/getting-started.html" class="active">Docs</a></li><li><a href="/relay/support.html" class="">Support</a></li><li><a href="https://github.com/facebook/relay" class="">GitHub</a></li></ul></div></div><section class="content wrap documentationContent"><div class="inner-content"><a id="content"></a><h1>FragmentContainer</h1><div><p>The primary way to declare data requirements is via <code>createFragmentContainer</code> — a higher-order React component that lets React components encode their data requirements.</p><p>Similar to how a React component&#x27;s <code>render</code> method does not directly modify native views, Relay containers do not directly fetch data. Instead, containers declare a <em>specification</em> of the data needed to render. Relay guarantees that this data is available <em>before</em> rendering.</p><h2><a class="anchor" name="a-complete-example"></a>A Complete Example <a class="hash-link" href="#a-complete-example">#</a></h2><p>To start, let&#x27;s build the plain React version of a <code>&lt;TodoItem&gt;</code> component that displays the text and completion status of a <code>Todo</code>.</p><h3><a class="anchor" name="base-react-component"></a>Base React Component <a class="hash-link" href="#base-react-component">#</a></h3><p>Here&#x27;s a basic implementation of <code>&lt;TodoItem&gt;</code> that ignores styling in order to highlight the functionality:</p><pre class="prism language-javascript">
<span class="token keyword">class</span> <span class="token class-name">TodoItem</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span spellcheck="true" class="token comment">// Expects the `item` prop to have the following shape:</span>
    <span spellcheck="true" class="token comment">// {</span>
    <span spellcheck="true" class="token comment">//   item: {</span>
    <span spellcheck="true" class="token comment">//     text,</span>
    <span spellcheck="true" class="token comment">//     isComplete</span>
    <span spellcheck="true" class="token comment">//   }</span>
    <span spellcheck="true" class="token comment">// }</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>item<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>View<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Checkbox checked<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>isComplete<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre><h3><a class="anchor" name="data-dependencies-with-graphql"></a>Data Dependencies With GraphQL <a class="hash-link" href="#data-dependencies-with-graphql">#</a></h3><p>In Relay, data dependencies are described using <a href="https://github.com/facebook/graphql" target="_blank">GraphQL</a>. For <code>&lt;TodoItem&gt;</code>, the dependency can be expressed as follows. Note that this exactly matches the shape that the component expected for the <code>item</code> prop.</p><p>A naming convention of <code>&lt;FileName&gt;_&lt;propName&gt;</code> for fragments is advised. This restriction is required while migrating from classic to modern APIs to allow for cross-compatibility.</p><pre class="prism language-javascript">
graphql`
  # This fragment only applies to objects <span class="token keyword">of</span> type <span class="token string">&#x27;Todo&#x27;</span><span class="token punctuation">.</span>
  fragment TodoItem_item on Todo <span class="token punctuation">{</span>
    text
    isComplete
  <span class="token punctuation">}</span>
`</pre><h3><a class="anchor" name="relay-containers"></a>Relay Containers <a class="hash-link" href="#relay-containers">#</a></h3><p>Given the plain React component and a GraphQL fragment, we can now define a <code>Container</code> to tell Relay about this component&#x27;s data requirements. Let&#x27;s look at the code first and then see what&#x27;s happening:</p><pre class="prism language-javascript">
<span class="token keyword">class</span> <span class="token class-name">TodoItem</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span><span spellcheck="true" class="token comment">/* as above */</span><span class="token punctuation">}</span>

<span spellcheck="true" class="token comment">// Export a *new* React component that wraps the original `&lt;TodoItem&gt;`.</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">createFragmentContainer</span><span class="token punctuation">(</span>TodoItem<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span spellcheck="true" class="token comment">// For each of the props that depend on server data, we define a corresponding</span>
  <span spellcheck="true" class="token comment">// key in this object. Here, the component expects server data to populate the</span>
  <span spellcheck="true" class="token comment">// `item` prop, so we&#x27;ll specify the fragment from above at the `item` key.</span>
  <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> graphql<span class="token template-string"><span class="token string">`
      fragment TodoItem_item on Todo {
        text
        isComplete
      }
    `</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>The example above is very similar to the classic container API, but in the modern API we can just pass the <code>graphql</code> template literal directly as the second argument. Relay will infer the prop name from the fragment name according to the fragment naming convention <code>&lt;FileName&gt;_&lt;propName&gt;</code>. The example below is equivalent to the one above:</p><pre class="prism language-javascript">
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">createFragmentContainer</span><span class="token punctuation">(</span>
  TodoItem<span class="token punctuation">,</span>
  graphql<span class="token template-string"><span class="token string">`
    fragment TodoItem_item on Todo {
      text
      isComplete
    }
  `</span></span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>If there is no <code>_&lt;propName&gt;</code> suffix, the <code>data</code> prop name will be used:</p><pre class="prism language-javascript">
<span class="token keyword">class</span> <span class="token class-name">TodoItem</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">createFragmentContainer</span><span class="token punctuation">(</span>
  TodoItem<span class="token punctuation">,</span>
  graphql<span class="token template-string"><span class="token string">`
    fragment TodoItem on Todo {
      text
      isComplete
    }
  `</span></span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><h2><a class="anchor" name="container-composition"></a>Container Composition <a class="hash-link" href="#container-composition">#</a></h2><p>React and Relay support creating arbitrarily complex applications through <em>composition</em>. Larger components can be created by composing smaller components, helping us to create modular, robust applications. There are two aspects to composing components in Relay:</p><ul><li>Composing the view logic, and</li><li>Composing the data descriptions.</li></ul><p>Let&#x27;s explore how this works via a <code>&lt;TodoList&gt;</code> component that composes the <code>&lt;TodoItem&gt;</code> from above.</p><h3><a class="anchor" name="composing-views-it-s-plain-react"></a>Composing Views - It&#x27;s Plain React <a class="hash-link" href="#composing-views-it-s-plain-react">#</a></h3><p>View composition is <em>exactly</em> what you&#x27;re used to — Relay containers are standard React components. Here&#x27;s the <code>&lt;TodoList&gt;</code> component:</p><pre class="prism language-javascript">
<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span spellcheck="true" class="token comment">// Expects a `list` with a string `title`, as well as the information</span>
    <span spellcheck="true" class="token comment">// for the `&lt;TodoItem&gt;`s (we&#x27;ll get that next).</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>View<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span spellcheck="true" class="token comment">/* It works just like a React component, because it is one! */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span>list<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>list<span class="token punctuation">.</span>todoItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>TodoItem item<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre><h3><a class="anchor" name="composing-fragments"></a>Composing Fragments <a class="hash-link" href="#composing-fragments">#</a></h3><p>Fragment composition works similarly — a parent container&#x27;s fragment composes the fragment for each of its children. In this case, <code>&lt;TodoList&gt;</code> needs to fetch information about the <code>Todo</code>s that are required by <code>&lt;TodoItem&gt;</code>.</p><pre class="prism language-javascript">
<span class="token keyword">class</span> <span class="token class-name">TodoList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span><span spellcheck="true" class="token comment">/* as above */</span><span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">createFragmentContainer</span><span class="token punctuation">(</span>
  TodoList<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span spellcheck="true" class="token comment">// This `_list` fragment name suffix corresponds to the prop named `list` that</span>
  <span spellcheck="true" class="token comment">// is expected to be populated with server data by the `&lt;TodoList&gt;` component.</span>
  graphql`
    fragment TodoList_list on TodoList <span class="token punctuation">{</span>
      # Specify any fields required by <span class="token string">&#x27;&lt;TodoList&gt;&#x27;</span> itself<span class="token punctuation">.</span>
      title<span class="token punctuation">,</span>
      # Include a reference to the fragment <span class="token keyword">from</span> the child component<span class="token punctuation">.</span>
      todoItems <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>TodoItem_item
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  `<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>Note that when composing fragments, the type of the composed fragment must match the field on the parent in which it is embedded. For example, it wouldn&#x27;t make sense to embed a fragment of type <code>Story</code> into a parent&#x27;s field of type <code>User</code>. Relay and GraphQL will provide helpful error messages if you get this wrong (and if they aren&#x27;t helpful, let us know!).</p><h2><a class="anchor" name="rendering-containers"></a>Rendering Containers <a class="hash-link" href="#rendering-containers">#</a></h2><p>As we&#x27;ve learned, Relay fragment containers declare data requirements as GraphQL fragments.
We&#x27;re almost ready to let Relay fulfill the data requirements for these components and render them. However, there is one problem. In order to actually fetch data with GraphQL, we need a query root. For example, we need to ground the <code>&lt;TodoList&gt;</code> fragment in a GraphQL query.</p><p>In Relay, the root of a query is defined by a <strong>QueryRenderer</strong> so check out that section for more details.</p></div><div class="docs-prevnext"><a class="docs-next" href="refetch-container.html">Next →</a></div></div><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/getting-started.html">Getting Started</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/tutorial.html">Tutorial</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/thinking-in-graphql.html">Thinking in GraphQL</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/thinking-in-relay.html">Thinking In Relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/videos.html">Videos</a></li></ul></div><div class="nav-docs-section"><h3>Relay Modern</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/relay-modern.html">Introduction to Relay Modern</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/new-in-relay-modern.html">New in Relay Modern</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/relay-environment.html">The Relay &quot;Environment&quot;</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/network-layer.html">The Relay Network Layer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/query-renderer.html">QueryRenderer</a></li><li><a style="margin-left:0;" class="active" href="/relay/docs/fragment-container.html">FragmentContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/refetch-container.html">RefetchContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/pagination-container.html">PaginationContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/routing.html">Routing</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/babel-plugin-relay.html">babel-plugin-relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/relay-compiler.html">Relay Compiler</a></li></ul></div><div class="nav-docs-section"><h3>Relay Compat</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/relay-compat.html">Compatibility Mode</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/conversion-playbook.html">Conversion Playbook</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/conversion-scripts.html">Conversion Scripts</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/upgrading-setvariables.html">Upgrading setVariables</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/compatibility-cheatsheet.html">Compatibility Cheatsheet</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-cheatsheet.html">API Cheatsheet</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic Guides</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/guides-containers.html">Containers</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-routes.html">Routes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-root-container.html">Root Container</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-ready-state.html">Ready State</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-network-layer.html">Network Layer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-babel-plugin.html">Babel Relay Plugin</a></li></ul></div><div class="nav-docs-section"><h3>GraphQL</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-relay-specification.html">GraphQL Relay Specification</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-object-identification.html">Object Identification</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-connections.html">Connection</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-further-reading.html">Further Reading</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic API</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay.html">Relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-container.html">RelayContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-route.html">Relay.Route</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-renderer.html">Relay.Renderer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-root-container.html">Relay.RootContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-ql.html">Relay.QL</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-mutation.html">Relay.Mutation</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-graphql-mutation.html">Relay.GraphQLMutation</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-proptypes.html">Relay.PropTypes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-store.html">Relay.Store</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic Interfaces</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-network-layer.html">RelayNetworkLayer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-mutation-request.html">RelayMutationRequest</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-query-request.html">RelayQueryRequest</a></li></ul></div></div></section><footer><span><a class="edit-page-link" href="https://github.com/facebook/relay/blob/master/docs/FragmentContainer.md" target="_blank">Edit This Page</a></span><span>Copyright © 2017 Facebook Inc</span></footer></div><div id="fb-root"></div><script>
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
              ga('create', 'UA-71174216-1', 'auto');
              ga('send', 'pageview');
          </script></body></html>