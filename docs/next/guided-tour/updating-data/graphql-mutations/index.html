<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guided-tour/updating-data/graphql-mutations" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>GraphQL mutations | Relay</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://relay.dev/img/relay.png /><meta data-rh=true name=twitter:image content=https://relay.dev/img/relay.png /><meta data-rh=true property=og:url content=https://relay.dev/docs/next/guided-tour/updating-data/graphql-mutations/ /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="GraphQL mutations | Relay"/><meta data-rh=true name=description content="Relay guide to GraphQL mutations"/><meta data-rh=true property=og:description content="Relay guide to GraphQL mutations"/><meta data-rh=true name=keywords content=mutation /><link data-rh=true rel=icon href=/img/favicon.png /><link data-rh=true rel=canonical href=https://relay.dev/docs/next/guided-tour/updating-data/graphql-mutations/ /><link data-rh=true rel=alternate href=https://relay.dev/docs/next/guided-tour/updating-data/graphql-mutations/ hreflang=en /><link data-rh=true rel=alternate href=https://relay.dev/docs/next/guided-tour/updating-data/graphql-mutations/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://UBPJPW35NS-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://relay.dev/docs/next/guided-tour/updating-data/graphql-mutations/","name":"GraphQL mutations","position":1}]}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Relay RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Relay Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-DCSC7FDGL5","auto"),ga("send","pageview")</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-DCSC7FDGL5"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DCSC7FDGL5",{})</script><link rel=search type=application/opensearchdescription+xml title=Relay href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.deec89cd.css /><script src=/assets/js/runtime~main.a8bcdfc7.js defer></script><script src=/assets/js/main.a2788f68.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>

<div style="display: none; text-align: center; background-color: white; color: black;" id=internaldocs-banner></div><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top navbar--primary"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><b class="navbar__title text--truncate">Relay</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/>Docs</a><a class="navbar__item navbar__link" href=/blog/>Blog</a><a class="navbar__item navbar__link" href=/help/>Help</a><a href=https://github.com/facebook/relay target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/docs/next/guided-tour/updating-data/graphql-mutations/>Next ðŸš§</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/next/guided-tour/updating-data/graphql-mutations/>Next ðŸš§</a><li><a class=dropdown__link href=/docs/guided-tour/updating-data/graphql-mutations/>v20.1.0</a><li><a class=dropdown__link href=/docs/v20.0.0/guided-tour/updating-data/graphql-mutations/>v20.0.0</a><li><a class=dropdown__link href=/docs/v19.0.0/guided-tour/updating-data/graphql-mutations/>v19.0.0</a><li><a class=dropdown__link href=/docs/v18.0.0/guided-tour/updating-data/graphql-mutations/>v18.0.0</a><li><a class=dropdown__link href=/docs/v17.0.0/guided-tour/updating-data/graphql-mutations/>v17.0.0</a><li><a class=dropdown__link href=/docs/v16.0.0/guided-tour/updating-data/graphql-mutations/>v16.0.0</a><li><a class=dropdown__link href=/docs/v15.0.0/guided-tour/updating-data/graphql-mutations/>v15.0.0</a><li><a class=dropdown__link href=/docs/v14.0.0/guided-tour/updating-data/graphql-mutations/>v14.0.0</a><li><a class=dropdown__link href=/docs/v13.0.0/guided-tour/updating-data/graphql-mutations/>v13.0.0</a><li><a class=dropdown__link href=/versions/>All versions</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/next/><span title=Home class=linkLabel_WmDU>Home</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/next/getting-started/quick-start/><span title="Get Started" class=categoryLinkLabel_W154>Get Started</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/next/tutorial/intro/><span title=Tutorial class=categoryLinkLabel_W154>Tutorial</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/docs/next/guided-tour/list-data/connections/><span title="Feature Guides" class=categoryLinkLabel_W154>Feature Guides</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guided-tour/list-data/connections/><span title="Fetching Data" class=categoryLinkLabel_W154>Fetching Data</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guides/required-directive/><span title="Error Handling" class=categoryLinkLabel_W154>Error Handling</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/docs/next/guided-tour/updating-data/introduction/><span title="Updating Data" class=categoryLinkLabel_W154>Updating Data</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/introduction/><span title=Introduction class=linkLabel_WmDU>Introduction</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/next/guided-tour/updating-data/graphql-mutations/><span title="GraphQL mutations" class=linkLabel_WmDU>GraphQL mutations</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/list-data/updating-connections/><span title="Updating Connections" class=linkLabel_WmDU>Updating Connections</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/imperatively-modifying-store-data/><span title="Imperatively modifying store data" class=linkLabel_WmDU>Imperatively modifying store data</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/imperatively-modifying-linked-fields/><span title="Imperatively modifying linked fields" class=linkLabel_WmDU>Imperatively modifying linked fields</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/typesafe-updaters-faq/><span title="Typesafe updaters FAQ" class=linkLabel_WmDU>Typesafe updaters FAQ</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/local-data-updates/><span title="Local Data Updates" class=linkLabel_WmDU>Local Data Updates</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/next/guided-tour/updating-data/client-only-data/><span title="Client-only data" class=linkLabel_WmDU>Client-only data</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guided-tour/reusing-cached-data/><span title=Caching class=categoryLinkLabel_W154>Caching</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guides/relay-resolvers/introduction/><span title="Client Side Data" class=categoryLinkLabel_W154>Client Side Data</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guides/graphql-server-specification/><span title="GraphQL Server and Network" class=categoryLinkLabel_W154>GraphQL Server and Network</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guides/type-emission/><span title=Typing class=categoryLinkLabel_W154>Typing</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/docs/next/guides/codemods/><span title=Codemods class=categoryLinkLabel_W154>Codemods</span></a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/next/api-reference/relay-environment-provider/><span title="API Reference" class=categoryLinkLabel_W154>API Reference</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/next/guides/testing-relay-components/><span title="Testing and Debugging" class=categoryLinkLabel_W154>Testing and Debugging</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/docs/next/principles-and-architecture/thinking-in-graphql/><span title="Principles and Architecture" class=categoryLinkLabel_W154>Principles and Architecture</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/next/community-learning-resources/><span title="Community Learning Resources" class=linkLabel_WmDU>Community Learning Resources</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/docs/next/glossary/><span title=Glossary class=linkLabel_WmDU>Glossary</span></a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is unreleased documentation for <!-- -->Relay<!-- --> <b>Next ðŸš§</b> version.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/docs/guided-tour/updating-data/graphql-mutations/>latest version</a></b> (<!-- -->v20.1.0<!-- -->).</div></div><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Feature Guides</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Updating Data</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>GraphQL mutations</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next ðŸš§</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>GraphQL mutations</h1></header><p>In GraphQL, data on the server is updated using <a href=https://graphql.org/learn/mutations/ target=_blank rel="noopener noreferrer" class="">GraphQL mutations</a> -- analogous to an HTTP POST request. Mutations are read-write server operations, which both modify the data on the backend and allow you to query the modified data in the same request. Note that mutations are opaque to Relay and don't directly update the Relay store, they are high-level requests sent to the server to express a user's intent.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=writing-mutations>Writing Mutations<a href=#writing-mutations class=hash-link aria-label="Direct link to Writing Mutations" title="Direct link to Writing Mutations" translate=no>â€‹</a></h2>
<p>A GraphQL mutation looks very similar to a query, except that it uses the <code>mutation</code> keyword:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token maybe-class-name">StoryLikeButtonLikeMutation</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> graphql</span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql keyword" style=color:#00009f>mutation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-mutation function" style=color:black>StoreLikeButtonLikeMutation</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql"></span><br/></span><span class="token-line color1" style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql variable variable-input" style=color:black>$id</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql scalar">ID</span><span class="token template-string graphql language-graphql operator" style=color:#b58a5e>!</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class="token-line color2" style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql property-query property-mutation">likeStory</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql attr-name" style=color:#2a6883>id</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql variable variable-input" style=color:black>$id</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class="token-line color3" style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql object">story</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property" style=color:black>likeCount</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql"></span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token punctuation" style=color:#b58a5e>;</span><br/></span></code></pre></div></div>
<ul>
<li class="">This mutation is named <code>StoryLikeButton</code> + <code>Like</code> + <code>Mutation</code> (note it must begin with the module name and end with the GraphQL operation).</li>
<li class="">A mutation may declare <span class=color1>variables</span> which are passed from the client to the server when the mutation is dispatched. Each variable has a name (<code>$id</code>) and a type (<code>ID!</code>).</li>
<li class="">The mutation selects a <span class=color2>mutation field</span> defined in the GraphQL schema. Each mutation field that the server defines should correspond to some action that the client can request of the server, such as liking a story. Just like any field, a mutation field can accept arguments to send to the server.</li>
<li class="">The <code>likeStory</code> field returns an edge to a node that represents the mutation response. The fields that are available in the mutation response are specified by the GraphQL schema. In this example, we select the <code>story</code> field, which is an <span class=color3>edge to the Story that we just liked</span>. From the <code>story</code> field, we can query any fields on the Story type, such as the <code>likeCount</code>.</li>
</ul>
<!-- -->
<p>A mutation is handled in two separate steps: first, the update is processed on the server, and then the query is executed. This ensures that you only see data that has already been updated as part of your mutation response.</p>
<!-- -->
<p>An example of a successful response for the above mutation could look like this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token property" style=color:black>"likeStory"</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token property" style=color:black>"story"</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token property" style=color:black>"id"</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token string" style=color:#65822b>"34a8c"</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token property" style=color:black>"likeCount"</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token number" style=color:black>47</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token punctuation" style=color:#b58a5e>}</span><br/></span></code></pre></div></div>
<p>In the simple case, Relay will automatically update the data in the local store with this new information. In some more complex cases, custom code will be required to tell Relay handle the updates. Read more about this in the [Updaters] section.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>Best Practice</div><div class=admonitionContent_BuS1><p>In the above example, we select fields individually in the mutation response. Often, these fields will be the same as a fragment related to the mutation (for example, a query for some <code>StoryLikeButton</code> component). Rather than have two separate sets of fields that should be kept in sync, it's best practice to spread the component fragment into the mutation response. This way, whenever the fragment changes in your code, the mutation will also return the correct updated data.<p>For example,<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token maybe-class-name">StoryLikeButtonLikeMutation</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> graphql</span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql keyword" style=color:#00009f>mutation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-mutation function" style=color:black>StoryLikeButtonLikeMutation</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql variable variable-input" style=color:black>$id</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql scalar">ID</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>,</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql property-query property-mutation">likeStory</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql attr-name" style=color:#2a6883>id</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql variable variable-input" style=color:black>$id</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql object">story</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql operator" style=color:#b58a5e>...</span><span class="token template-string graphql language-graphql fragment function" style=color:black>StoryLikeButtonFragment</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql"></span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token punctuation" style=color:#b58a5e>;</span><br/></span></code></pre></div></div><p>Spreading fragments is also generally preferable to refetching the data after a mutation has completed, since the updated data can be fetched in a single round trip.</div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p><strong>How does Relay know how to update the store?</strong>
Whenever the response includes an object with an <code>id</code> field, Relay will check if the store already contains a record with a matching <code>ID</code> in the <code>id</code> field of that record. If there is a match, Relay will merge the other fields from the response into the existing record.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=using-a-mutation-in-relay>Using a mutation in Relay<a href=#using-a-mutation-in-relay class=hash-link aria-label="Direct link to Using a mutation in Relay" title="Direct link to Using a mutation in Relay" translate=no>â€‹</a></h2>
<p>Mutations in Relay are accessed using the <a class="" href=/docs/next/api-reference/use-mutation/><code>useMutation</code></a> hook. The hook returns a function to actually send the mutation to the server (e.g. <code>commitMutation</code> below), along with a boolean variable to indicate if a mutation is in flight (e.g. <code>isMutationInFlight</code>). This is useful for showing pending states like a loading spinner or disabling a "submit" button.</p>
<p>For example, using the <code>StoryLikeButtonLikeMutation</code> above:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>[</span><span class="token plain">commitMutation</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> isMutationInFlight</span><span class="token punctuation" style=color:#b58a5e>]</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> </span><span class="token function" style=color:black>useMutation</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token maybe-class-name">StoryLikeButtonLikeMutation</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function" style=color:black>onLikeButtonClicked</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token function" style=color:black>commitMutation</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token literal-property property" style=color:black>variables</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token literal-property property" style=color:black>id</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">id</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token maybe-class-name">LikeButton</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>&lt;</span><span class="token plain">button onClick</span><span class="token operator" style=color:#b58a5e>=</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain">onLikeButtonClicked</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"> disabled</span><span class="token operator" style=color:#b58a5e>=</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain">isMutationInFlight</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token operator" style=color:#b58a5e>></span><span class="token maybe-class-name">Like</span><span class="token operator" style=color:#b58a5e>&lt;</span><span class="token operator" style=color:#b58a5e>/</span><span class="token plain">button</span><span class="token operator" style=color:#b58a5e>></span><br/></span></code></pre></div></div>
<p>Note that <code>commitMutation</code> takes the variables defined on the mutation in the form of an object.</p>
<p>Once that field is executed, the backend will select the updated Feedback object and select <code>like_count</code> field off of it. Since the <code>Story</code> type contains an <code>id</code> field, the Relay compiler will automatically add a selection for the <code>id</code> field. When the mutation response is received, Relay will find a feedback object in the store with a matching <code>id</code> and update it with the newly received <code>like_count</code> value. If this value changes as a result, any components using the value re-rendered.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>If you are using TypeScript or Flow, it's best practice to include a type parameters to the <code>useMutation</code> hook:<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token maybe-class-name">StoryLikeButtonLikeMutation$data</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> </span><span class="token maybe-class-name">StoryLikeButtonLikeMutation$variables</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#65822b>'StoryLikeButtonLikeMutation.graphql'</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>[</span><span class="token plain">commitMutation</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> isMutationInFlight</span><span class="token punctuation" style=color:#b58a5e>]</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> </span><span class="token generic-function function" style=color:black>useMutation</span><span class="token generic-function generic class-name operator" style=color:#b58a5e>&lt;</span><span class="token generic-function generic class-name"></span><br/></span><span class=token-line style=color:black><span class="token generic-function generic class-name">  StoryLikeButtonLikeMutationType$variables</span><span class="token generic-function generic class-name punctuation" style=color:#b58a5e>,</span><span class="token generic-function generic class-name"></span><br/></span><span class=token-line style=color:black><span class="token generic-function generic class-name">  StoryLikeButtonLikeMutationType$data</span><span class="token generic-function generic class-name punctuation" style=color:#b58a5e>,</span><span class="token generic-function generic class-name"></span><br/></span><span class=token-line style=color:black><span class="token generic-function generic class-name"></span><span class="token generic-function generic class-name operator" style=color:#b58a5e>></span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token maybe-class-name">StoryLikeButtonLikeMutation</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>;</span><br/></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=executing-a-callback-when-the-mutation-completes-or-errors>Executing a callback when the mutation completes or errors<a href=#executing-a-callback-when-the-mutation-completes-or-errors class=hash-link aria-label="Direct link to Executing a callback when the mutation completes or errors" title="Direct link to Executing a callback when the mutation completes or errors" translate=no>â€‹</a></h2>
<p>We may want to update some state in response to the mutation succeeding or failing. For example, we might want to alert the user if the mutation failed. The <code>UseMutationConfig</code> object passed to <code>commitMutation</code> can include the following fields to handle such cases:</p>
<ul>
<li class=""><code>onCompleted</code>, a callback that is executed when the mutation completes. It is passed the mutation response (stopping at fragment spread boundaries).<!-- -->
<ul>
<li class="">The value passed to <code>onCompleted</code> is the the mutation fragment, as read out from the store, <strong>after</strong> updaters and declarative mutation directives are applied. This means that data from within unmasked fragments will not be read, and records that were deleted (e.g. by <code>@deleteRecord</code>) may also be null.</li>
</ul>
</li>
<li class=""><code>onError</code>, a callback that is executed when the mutation errors. It is passed the error that occurred.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=declarative-mutation-directives>Declarative mutation directives<a href=#declarative-mutation-directives class=hash-link aria-label="Direct link to Declarative mutation directives" title="Direct link to Declarative mutation directives" translate=no>â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=manipulating-connections-in-response-to-mutations>Manipulating connections in response to mutations<a href=#manipulating-connections-in-response-to-mutations class=hash-link aria-label="Direct link to Manipulating connections in response to mutations" title="Direct link to Manipulating connections in response to mutations" translate=no>â€‹</a></h3>
<p>Relay makes it easy to respond to mutations by adding or removing items from connections (i.e. lists). For example, you might want to append a newly created user to a given connection. For more, see <a class="" href=/docs/next/guided-tour/list-data/updating-connections/#using-declarative-directives>Using declarative directives</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=deleting-items-in-response-to-mutations>Deleting items in response to mutations<a href=#deleting-items-in-response-to-mutations class=hash-link aria-label="Direct link to Deleting items in response to mutations" title="Direct link to Deleting items in response to mutations" translate=no>â€‹</a></h3>
<p>In addition, you might want to delete an item from the store in response to a mutation. In order to do this, you would add the <code>@deleteRecord</code> directive to the deleted ID. For example:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword" style=color:#00009f>mutation</span><span class="token plain"> </span><span class="token definition-mutation function" style=color:black>DeletePostMutation</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token variable variable-input" style=color:black>$input</span><span class="token punctuation" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token class-name">DeletePostData</span><span class="token operator" style=color:#b58a5e>!</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token property-query property-mutation">delete_post</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token attr-name" style=color:#2a6883>data</span><span class="token punctuation" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token variable variable-input" style=color:black>$input</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token object">deleted_post</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token property" style=color:black>id</span><span class="token plain"> </span><span class="token directive function" style=color:black>@deleteRecord</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token punctuation" style=color:#b58a5e>}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=imperatively-modifying-local-data>Imperatively modifying local data<a href=#imperatively-modifying-local-data class=hash-link aria-label="Direct link to Imperatively modifying local data" title="Direct link to Imperatively modifying local data" translate=no>â€‹</a></h2>
<p>At times, the updates you wish to perform are more complex than just updating the values of fields and cannot be handled by the declarative mutation directives. For such situations, the <code>UseMutationConfig</code> accepts an <code>updater</code> function which gives you full control over how to update the store.</p>
<p>This is discussed in more detail in the section on <a class="" href=/docs/next/guided-tour/updating-data/imperatively-modifying-store-data/>Imperatively modifying store data</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=optimistic-updates>Optimistic updates<a href=#optimistic-updates class=hash-link aria-label="Direct link to Optimistic updates" title="Direct link to Optimistic updates" translate=no>â€‹</a></h2>
<p>Oftentimes, we don't want to wait for the server to respond before we respond to the user interaction. For example, if a user clicks the "Like" button, we would like to instantly show the affected comment, post, etc. has been liked by the user.</p>
<p>More generally, in these cases, we want to immediately update the data in our store optimistically, i.e. under the assumption that the mutation will complete successfully. If the mutation ends up not succeeding, we would like to roll back that optimistic update.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=optimistic-response>Optimistic response<a href=#optimistic-response class=hash-link aria-label="Direct link to Optimistic response" title="Direct link to Optimistic response" translate=no>â€‹</a></h3>
<p>In order to enable optimistic udpates, the <code>UseMutationConfig</code> can include an <code>optimisticResponse</code> field.</p>
<p>For this field to be Flow-typed, the call to <code>useMutation</code> must be passed a Flow type parameter <strong>and</strong> the mutation must be decorated with a <code>@raw_response_type</code> directive.</p>
<p>In the previous example, we might provide the following optimistic response:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token literal-property property" style=color:black>feedback_like</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token literal-property property" style=color:black>feedback</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// Even though the id field is not explicitly selected, the</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>// compiler selected it for us</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token literal-property property" style=color:black>id</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> feedbackId</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token literal-property property" style=color:black>viewer_does_like</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token boolean" style=color:black>true</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token punctuation" style=color:#b58a5e>}</span><br/></span></code></pre></div></div>
<p>Now, when we call <code>commitMutation</code>, this data will be immediately written into the store. The item in the store with the matching id will be updated with a new value of <code>viewer_does_like</code>. Any components which have selected this field will be re-rendered.</p>
<p>When the mutation succeeds or errors, the optimistic response will be rolled back.</p>
<p>Updating the <code>like_count</code> field takes a bit more work. In order to update it, we should also read the <strong>current like count</strong> in the component.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:black;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-js codeBlock_bY9V thin-scrollbar" style=color:black;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:black><span class="token keyword module" style=color:#00009f>import</span><span class="token plain"> type </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token maybe-class-name">FeedbackLikeData</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> </span><span class="token maybe-class-name">LikeButtonMutation</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#65822b>'LikeButtonMutation.graphql'</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword module" style=color:#00009f>import</span><span class="token plain"> type </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token maybe-class-name">LikeButton_feedback$fragmentType</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"> </span><span class="token keyword module" style=color:#00009f>from</span><span class="token plain"> </span><span class="token string" style=color:#65822b>'LikeButton_feedback.graphql'</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain">useMutation</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> graphql</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> </span><span class="token function" style=color:black>require</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token string" style=color:#65822b>'react-relay'</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token keyword" style=color:#00009f>function</span><span class="token plain"> </span><span class="token function maybe-class-name" style=color:black>LikeButton</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token parameter punctuation" style=color:#b58a5e>{</span><span class="token parameter"></span><br/></span><span class=token-line style=color:black><span class="token parameter">  </span><span class="token parameter literal-property property" style=color:black>feedback</span><span class="token parameter operator" style=color:#b58a5e>:</span><span class="token parameter"> </span><span class="token parameter maybe-class-name">LikeButton_feedback$fragmentType</span><span class="token parameter punctuation" style=color:#b58a5e>,</span><span class="token parameter"></span><br/></span><span class=token-line style=color:black><span class="token parameter"></span><span class="token parameter punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> data </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> </span><span class="token function" style=color:black>useFragment</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style=color:#00009f>fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style=color:black>LikeButton_feedback</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style=color:#00009f>on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Feedback</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property" style=color:black>__id</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property" style=color:black>viewer_does_like</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style=color:black>@required</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql attr-name" style=color:#2a6883>action</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql constant" style=color:black>THROW</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property" style=color:black>like_count</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style=color:black>@required</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql attr-name" style=color:#2a6883>action</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql constant" style=color:black>THROW</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    feedback</span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>[</span><span class="token plain">commitMutation</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"> isMutationInFlight</span><span class="token punctuation" style=color:#b58a5e>]</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> useMutation</span><span class="token operator" style=color:#b58a5e>&lt;</span><span class="token maybe-class-name">LikeButtonMutation</span><span class="token operator" style=color:#b58a5e>></span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style=color:#00009f>mutation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-mutation function" style=color:black>LikeButtonMutation</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql variable variable-input" style=color:black>$input</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">FeedbackLikeData</span><span class="token template-string graphql language-graphql operator" style=color:#b58a5e>!</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql directive function" style=color:black>@raw_response_type</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property-query">feedback_like</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>(</span><span class="token template-string graphql language-graphql attr-name" style=color:#2a6883>data</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql variable" style=color:black>$input</span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql object">feedback</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>{</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql property" style=color:black>viewer_does_like</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql property" style=color:black>like_count</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style=color:#b58a5e>}</span><span class="token template-string graphql language-graphql"></span><br/></span><span class=token-line style=color:black><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style=color:#65822b>`</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> changeToLikeCount </span><span class="token operator" style=color:#b58a5e>=</span><span class="token plain"> data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">viewer_does_like</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>?</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>-</span><span class="token number" style=color:black>1</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token number" style=color:black>1</span><span class="token punctuation" style=color:#b58a5e>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token keyword control-flow" style=color:#00009f>return</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>&lt;</span><span class="token plain">button</span><br/></span><span class=token-line style=color:black><span class="token plain">    onClick</span><span class="token operator" style=color:#b58a5e>=</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token plain"> </span><span class="token arrow operator" style=color:#b58a5e>=></span><span class="token plain"> </span><span class="token function" style=color:black>commitMutation</span><span class="token punctuation" style=color:#b58a5e>(</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token literal-property property" style=color:black>variables</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">        </span><span class="token literal-property property" style=color:black>input</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token literal-property property" style=color:black>id</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">__id</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token literal-property property" style=color:black>optimisticResponse</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">        </span><span class="token literal-property property" style=color:black>feedback_like</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">          </span><span class="token literal-property property" style=color:black>feedback</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">            </span><span class="token literal-property property" style=color:black>id</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">__id</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">            </span><span class="token literal-property property" style=color:black>viewer_does_like</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>!</span><span class="token plain">data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">viewer_does_like</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">            </span><span class="token literal-property property" style=color:black>like_count</span><span class="token operator" style=color:#b58a5e>:</span><span class="token plain"> data</span><span class="token punctuation" style=color:#b58a5e>.</span><span class="token property-access">like_count</span><span class="token plain"> </span><span class="token operator" style=color:#b58a5e>+</span><span class="token plain"> changeToLikeCount</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">          </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">        </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">      </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>,</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token punctuation" style=color:#b58a5e>)</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    disabled</span><span class="token operator" style=color:#b58a5e>=</span><span class="token punctuation" style=color:#b58a5e>{</span><span class="token plain">isMutationInFlight</span><span class="token punctuation" style=color:#b58a5e>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token operator" style=color:#b58a5e>></span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">    </span><span class="token maybe-class-name">Like</span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain">  </span><span class="token operator" style=color:#b58a5e>&lt;</span><span class="token operator" style=color:#b58a5e>/</span><span class="token plain">button</span><span class="token operator" style=color:#b58a5e>></span><span class="token plain"></span><br/></span><span class=token-line style=color:black><span class="token plain"></span><span class="token punctuation" style=color:#b58a5e>}</span><br/></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>You should be careful, and consider using <a class="" href=/docs/next/guided-tour/updating-data/imperatively-modifying-store-data/#example>optimistic updaters</a> if the value of the optimistic response depends on the value of the store and if there can be multiple optimistic responses affecting that store value.<p>For example, if <strong>two</strong> optimistic responses each increase the like count by one, and the <strong>first</strong> optimistic updater is rolled back, the second optimistic update will still be applied, and the like count in the store will remain increased by two.</div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_BuS1><p>Optimistic responses contain <strong>many pitfalls!</strong><ul>
<li class="">An optimistic response can contain the data for the full query response, i.e. including the content of fragment spreads. This means that if a developer selects more fields in components whose fragments are spread in an optimistic response, these components may have inconsistent or partial data during an optimistic update.</li>
<li class="">Because the type of the optimistic update includes the contents of all recursively nested fragments, it can be very large. Adding <code>@raw_response_type</code> to certain mutations can degrade the performance of the Relay compiler.</li>
</ul></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=optimistic-updaters>Optimistic updaters<a href=#optimistic-updaters class=hash-link aria-label="Direct link to Optimistic updaters" title="Direct link to Optimistic updaters" translate=no>â€‹</a></h3>
<p>Optimistic responses aren't enough for every case. For example, we may want to optimistically update data that we aren't selecting in the mutation. Or, we may want to add or remove items from a connection (and the declarative mutation directives are insufficient for our use case.)</p>
<p>For situations like these, the <code>UseMutationConfig</code> can contain an <code>optimisticUpdater</code> field, which allows developers to imperatively and optimistically update the data in the store. This is discussed in more detail in the section on <a class="" href=/docs/next/guided-tour/updating-data/imperatively-modifying-store-data/>Imperatively updating store data</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=order-of-execution-of-updater-functions>Order of execution of updater functions<a href=#order-of-execution-of-updater-functions class=hash-link aria-label="Direct link to Order of execution of updater functions" title="Direct link to Order of execution of updater functions" translate=no>â€‹</a></h2>
<p>In general, execution of the <code>updater</code> and optimistic updates will occur in the following order:</p>
<ul>
<li class="">If an <code>optimisticResponse</code> is provided, that data will be written into the store.</li>
<li class="">If an <code>optimisticUpdater</code> is provided, Relay will execute it and update the store accordingly.</li>
<li class="">If an <code>optimisticResponse</code> was provided, the declarative mutation directives present in the mutation will be processed on the optimistic response.</li>
<li class="">If the mutation request succeeds:<!-- -->
<ul>
<li class="">Any optimistic update that was applied will be rolled back.</li>
<li class="">Relay will write the server response to the store.</li>
<li class="">If an <code>updater</code> was provided, Relay will execute it and update the store accordingly. The server payload will be available to the <code>updater</code> as a root field in the store.</li>
<li class="">Relay will process any declarative mutation directives using the server response.</li>
<li class="">The <code>onCompleted</code> callback will be called.</li>
</ul>
</li>
<li class="">If the mutation request fails:<!-- -->
<ul>
<li class="">Any optimistic update was applied will be rolled back.</li>
<li class="">The <code>onError</code> callback will be called.</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>In the case that the store is updated while the mutation is still in flight, Relay will first revert your optimistic update, then apply the new store update before re-applying the optimistic update.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=invalidating-data-during-a-mutation>Invalidating data during a mutation<a href=#invalidating-data-during-a-mutation class=hash-link aria-label="Direct link to Invalidating data during a mutation" title="Direct link to Invalidating data during a mutation" translate=no>â€‹</a></h2>
<p>The recommended approach when executing a mutation is to request <em>all</em> the relevant data that was affected by the mutation back from the server (as part of the mutation body), so that our local Relay store is consistent with the state of the server.</p>
<p>However, often times it can be unfeasible to know and specify all the possible data that would be affected for mutations that have large rippling effects (e.g. imagine "blocking a user" or "leaving a group").</p>
<p>For these types of mutations, it's often more straightforward to explicitly mark some data as stale (or the whole store), so that Relay knows to refetch it the next time it is rendered. In order to do so, you can use the data invalidation APIs documented in our <a class="" href=/docs/next/guided-tour/reusing-cached-data/staleness-of-data/>Staleness of Data section</a>.</p>
<!-- -->
<div class=docsRating id=docsRating><hr/>Is this page useful?<svg class=i_thumbsup alt=Like id=docsRating-like xmlns=http://www.w3.org/2000/svg viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"/></svg><svg class=i_thumbsdown alt=Dislike id=docsRating-dislike xmlns=http://www.w3.org/2000/svg viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"/></svg><p>Help us make the site even better by<!-- --> <a href=https://www.surveymonkey.com/r/FYC9TCJ target=_blank rel="noopener noreferrer">answering a few quick questions</a>.</div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/facebook/relay/tree/main/website/docs/guided-tour/updating-data/graphql-mutations.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/next/guided-tour/updating-data/introduction/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/next/guided-tour/list-data/updating-connections/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Updating Connections</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#writing-mutations class="table-of-contents__link toc-highlight">Writing Mutations</a><li><a href=#using-a-mutation-in-relay class="table-of-contents__link toc-highlight">Using a mutation in Relay</a><li><a href=#executing-a-callback-when-the-mutation-completes-or-errors class="table-of-contents__link toc-highlight">Executing a callback when the mutation completes or errors</a><li><a href=#declarative-mutation-directives class="table-of-contents__link toc-highlight">Declarative mutation directives</a><ul><li><a href=#manipulating-connections-in-response-to-mutations class="table-of-contents__link toc-highlight">Manipulating connections in response to mutations</a><li><a href=#deleting-items-in-response-to-mutations class="table-of-contents__link toc-highlight">Deleting items in response to mutations</a></ul><li><a href=#imperatively-modifying-local-data class="table-of-contents__link toc-highlight">Imperatively modifying local data</a><li><a href=#optimistic-updates class="table-of-contents__link toc-highlight">Optimistic updates</a><ul><li><a href=#optimistic-response class="table-of-contents__link toc-highlight">Optimistic response</a><li><a href=#optimistic-updaters class="table-of-contents__link toc-highlight">Optimistic updaters</a></ul><li><a href=#order-of-execution-of-updater-functions class="table-of-contents__link toc-highlight">Order of execution of updater functions</a><li><a href=#invalidating-data-during-a-mutation class="table-of-contents__link toc-highlight">Invalidating data during a mutation</a><li><a href=#handling-errors class="table-of-contents__link toc-highlight">Handling errors</a><ul><li><a href=#surfacing-mutation-level-errors class="table-of-contents__link toc-highlight">Surfacing mutation level errors</a><li><a href=#surfacing-field-level-errors class="table-of-contents__link toc-highlight">Surfacing field level errors</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Docs</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item target=_self href=/docs/>Introduction</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item target=_self href=/users/>User Showcase</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Legal</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://opensource.facebook.com/legal/privacy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Privacy<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opensource.facebook.com/legal/terms/ target=_blank rel="noopener noreferrer" class=footer__link-item>Terms<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opensource.facebook.com/legal/data-policy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Data Policy<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opensource.facebook.com/legal/cookie-policy/ target=_blank rel="noopener noreferrer" class=footer__link-item>Cookie Policy<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/img/relay.svg class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/img/relay.svg class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"/></div><div class=footer__copyright>Copyright Â© 2026 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div></body>