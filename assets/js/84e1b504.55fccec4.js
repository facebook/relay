"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["43099"],{92610(e,r,n){n.r(r),n.d(r,{metadata:()=>s,default:()=>h,frontMatter:()=>l,contentTitle:()=>o,toc:()=>c,assets:()=>d});var s=JSON.parse('{"id":"api-reference/hooks/use-query-loader","title":"useQueryLoader","description":"API reference for useQueryLoader, a React hook used to imperatively fetch data for a query in response to a user event","source":"@site/versioned_docs/version-v15.0.0/api-reference/hooks/use-query-loader.md","sourceDirName":"api-reference/hooks","slug":"/api-reference/use-query-loader/","permalink":"/docs/v15.0.0/api-reference/use-query-loader/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v15.0.0/api-reference/hooks/use-query-loader.md","tags":[],"version":"v15.0.0","frontMatter":{"id":"use-query-loader","title":"useQueryLoader","slug":"/api-reference/use-query-loader/","description":"API reference for useQueryLoader, a React hook used to imperatively fetch data for a query in response to a user event","keywords":["query","fetch","preload","render-as-you-fetch"]},"sidebar":"docs","previous":{"title":"usePreloadedQuery","permalink":"/docs/v15.0.0/api-reference/use-preloaded-query/"},"next":{"title":"loadQuery","permalink":"/docs/v15.0.0/api-reference/load-query/"}}'),a=n(74848),t=n(28453),i=n(86898);let l={id:"use-query-loader",title:"useQueryLoader",slug:"/api-reference/use-query-loader/",description:"API reference for useQueryLoader, a React hook used to imperatively fetch data for a query in response to a user event",keywords:["query","fetch","preload","render-as-you-fetch"]},o,d={},c=[{value:"<code>useQueryLoader</code>",id:"usequeryloader",level:2},{value:"Arguments",id:"arguments",level:3},{value:"Return value",id:"return-value",level:3},{value:"Behavior",id:"behavior",level:3}];function u(e){let r={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h2,{id:"usequeryloader",children:(0,a.jsx)(r.code,{children:"useQueryLoader"})}),"\n",(0,a.jsx)(r.p,{children:"Hook used to make it easy to safely load and retain queries. It will keep a query reference stored in state, and dispose of it when the component is disposed or it is no longer accessible via state."}),"\n",(0,a.jsxs)(r.p,{children:["This hook is designed to be used with ",(0,a.jsx)(r.a,{href:"../use-preloaded-query",children:(0,a.jsx)(r.code,{children:"usePreloadedQuery"})}),' to implement the "render-as-you-fetch" pattern. For more information, see the ',(0,a.jsx)(r.a,{href:"../../guided-tour/rendering/queries/",children:"Fetching Queries for Render"})," guide."]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:"import type {PreloadedQuery} from 'react-relay';\n\nconst {useQueryLoader, usePreloadedQuery} = require('react-relay');\n\nconst AppQuery = graphql`\n  query AppQuery($id: ID!) {\n    user(id: $id) {\n      name\n    }\n  }\n`;\n\nfunction QueryFetcherExample() {\n  const [\n    queryReference,\n    loadQuery,\n    disposeQuery,\n  ] = useQueryLoader(\n    AppQuery,\n  );\n\n  if (queryReference == null) {\n    return (\n      <Button onClick={() => loadQuery({})}> Click to reveal the name </Button>\n    );\n  }\n\n  return (\n    <>\n      <Button onClick={disposeQuery}>\n        Click to hide the name and dispose the query.\n      </Button>\n      <React.Suspense fallback=\"Loading\">\n        <NameDisplay queryReference={queryReference} />\n      </React.Suspense>\n    </>\n  );\n}\n\nfunction NameDisplay({ queryReference }) {\n  const data = usePreloadedQuery(AppQuery, queryReference);\n\n  return <h1>{data.user?.name}</h1>;\n}\n"})}),"\n",(0,a.jsx)(r.h3,{id:"arguments",children:"Arguments"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"query"}),": GraphQL query specified using a ",(0,a.jsx)(r.code,{children:"graphql"})," template literal."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"initialQueryRef"}),": ",(0,a.jsx)(r.em,{children:(0,a.jsx)(r.em,{children:"[Optional]"})})," An initial ",(0,a.jsx)(r.code,{children:"PreloadedQuery"})," to be used as the initial value of the ",(0,a.jsx)(r.code,{children:"queryReference"})," stored in state and returned by ",(0,a.jsx)(r.code,{children:"useQueryLoader"}),"."]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"return-value",children:"Return value"}),"\n",(0,a.jsx)(r.p,{children:"A tuple containing the following values:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"queryReference"}),": the query reference, or ",(0,a.jsx)(r.code,{children:"null"}),"."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"loadQuery"}),": a callback that, when executed, will load a query, which will be accessible as ",(0,a.jsx)(r.code,{children:"queryReference"}),". If a previous query was loaded, it will dispose of it. It will throw an error if called during React's render phase.","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Parameters","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"variables"}),": the variables with which the query is loaded."]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"options"}),": ",(0,a.jsx)(r.code,{children:"LoadQueryOptions"}),". An optional options object, containing the following keys:","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"fetchPolicy"}),": ",(0,a.jsx)(r.em,{children:(0,a.jsx)(r.em,{children:"[Optional]"})})," Determines if cached data should be used, and when to send a network request based on the cached data that is currently available in the Relay store (for more details, see our ",(0,a.jsx)(r.a,{href:"../../guided-tour/reusing-cached-data/fetch-policies",children:"Fetch Policies"})," and ",(0,a.jsx)(r.a,{href:"../../guided-tour/reusing-cached-data/presence-of-data",children:"Garbage Collection"})," guides):","\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:['"store-or-network": ',(0,a.jsx)(r.em,{children:(0,a.jsx)(r.em,{children:"(default)"})})," ",(0,a.jsx)(r.em,{children:"will"})," reuse locally cached data and will ",(0,a.jsx)(r.em,{children:"only"})," send a network request if any data for the query is missing. If the query is fully cached, a network request will ",(0,a.jsx)(r.em,{children:"not"})," be made."]}),"\n",(0,a.jsxs)(r.li,{children:['"store-and-network": ',(0,a.jsx)(r.em,{children:"will"})," reuse locally cached data and will ",(0,a.jsx)(r.em,{children:"always"})," send a network request, regardless of whether any data was missing from the local cache or not."]}),"\n",(0,a.jsxs)(r.li,{children:['"network-only": ',(0,a.jsx)(r.em,{children:"will"})," ",(0,a.jsx)(r.em,{children:"not"})," reuse locally cached data, and will ",(0,a.jsx)(r.em,{children:"always"})," send a network request to fetch the query, ignoring any data that might be locally cached in Relay."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"networkCacheConfig"}),": ",(0,a.jsx)(r.em,{children:(0,a.jsx)(r.em,{children:"[Optional]"})})," Default value: ",(0,a.jsx)(r.code,{children:"{force: true}"}),". Object containing cache config options for the ",(0,a.jsx)(r.em,{children:"network layer"}),". Note that the network layer may contain an ",(0,a.jsx)(r.em,{children:"additional"})," query response cache which will reuse network responses for identical queries. If you want to bypass this cache completely (which is the default behavior), pass ",(0,a.jsx)(r.code,{children:"{force: true}"})," as the value for this option."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.code,{children:"disposeQuery"}),": a callback that, when executed, will set ",(0,a.jsx)(r.code,{children:"queryReference"})," to ",(0,a.jsx)(r.code,{children:"null"})," and call ",(0,a.jsx)(r.code,{children:".dispose()"})," on it. It has type ",(0,a.jsx)(r.code,{children:"() => void"}),". It should not be called during React's render phase."]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"behavior",children:"Behavior"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["The ",(0,a.jsx)(r.code,{children:"loadQuery"})," callback will fetch data if passed a query, or data and the query if passed a preloadable concrete request. Once both the query and data are available, the data from the query will be written to the store. This differs from the behavior of ",(0,a.jsx)(r.code,{children:"preloadQuery_DEPRECATED"}),", which would only write data to the store if the query was passed to ",(0,a.jsx)(r.code,{children:"usePreloadedQuery"}),"."]}),"\n",(0,a.jsxs)(r.li,{children:["This query reference will be retained by the Relay store, preventing the data from being garbage collected. Once ",(0,a.jsx)(r.code,{children:".dispose()"})," is called on the query reference, the data is liable to be garbage collected."]}),"\n",(0,a.jsxs)(r.li,{children:["The ",(0,a.jsx)(r.code,{children:"loadQuery"})," callback will throw an error if it is called during React's render phase."]}),"\n"]}),"\n",(0,a.jsx)(i.A,{})]})}function h(e={}){let{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},86898(e,r,n){n.d(r,{A:()=>p});var s=n(74848),a=n(95310),t=n(17352),i=n(96540);function l(){let e=window.encodeURI(JSON.stringify({title:"Feedback about "+window.location.pathname,description:"**!!! Required !!!**\n\nPlease modify the task description to let us know how the docs can be improved.\n\n**Please do not ask support questions via this form! Instead, ask in fburl.com/relay_support**",tag_ids:{add:[0xac96423e5b680,0x64079768ac750]}}));window.open("https://www.internalfb.com/tasks/?n="+e)}function o({children:e}){return(0,s.jsxs)("div",{className:"docsRating",id:"docsRating",children:[(0,s.jsx)("hr",{}),e]})}let d=()=>{let[e,r]=i.useState(!1),n=e=>{r(!0),window.ga&&window.ga("send",{hitType:"event",eventCategory:"button",eventAction:"feedback",eventValue:e})};return e?"Thank you for letting us know!":(0,s.jsxs)(s.Fragment,{children:["Is this page useful?",(0,s.jsx)("svg",{className:"i_thumbsup",alt:"Like",id:"docsRating-like",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>n(1),children:(0,s.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})}),(0,s.jsx)("svg",{className:"i_thumbsdown",alt:"Dislike",id:"docsRating-dislike",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>n(0),children:(0,s.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})})]})},c=()=>(0,s.jsxs)("p",{children:["Let us know how these docs can be improved by",(0,s.jsx)("a",{className:"button",role:"button",tabIndex:0,onClick:l,children:"Filing a task"})]}),u=()=>(0,s.jsxs)("p",{children:["Help us make the site even better by"," ",(0,s.jsx)(a.default,{to:"https://www.surveymonkey.com/r/FYC9TCJ",children:"answering a few quick questions"}),"."]}),h=()=>(0,s.jsxs)(o,{children:[(0,s.jsx)(c,{}),(0,s.jsx)(d,{}),(0,s.jsx)(u,{})]}),y=()=>(0,s.jsxs)(o,{children:[(0,s.jsx)(d,{}),(0,s.jsx)(u,{})]}),p=()=>(0,t.fbContent)({internal:(0,s.jsx)(h,{}),external:(0,s.jsx)(y,{})})},28453(e,r,n){n.d(r,{R:()=>i,x:()=>l});var s=n(96540);let a={},t=s.createContext(a);function i(e){let r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);