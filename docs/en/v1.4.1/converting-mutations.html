<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Converting Mutations · Relay</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="We made some changes to how mutations work in the new version of Relay in order to makes them more straight forward to use and more customizable. Mutations are currently not covered by an automatic conversion and require a manual upgrade. However, limited number of changes is needed to make your existing mutations work with both the old and new environment."/><meta name="docsearch:version" content="v1.4.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Converting Mutations · Relay"/><meta property="og:type" content="website"/><meta property="og:url" content="https://relay.dev/"/><meta property="og:description" content="We made some changes to how mutations work in the new version of Relay in order to makes them more straight forward to use and more customizable. Mutations are currently not covered by an automatic conversion and require a manual upgrade. However, limited number of changes is needed to make your existing mutations work with both the old and new environment."/><meta property="og:image" content="https://relay.dev/img/relay.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://relay.dev/img/relay.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="/js/redirect.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><h2 class="headerTitle">Relay</h2></a><a href="/en/versions"><h3>v1.4.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/en/v1.4.1/introduction-to-relay" target="_self">Docs</a></li><li class=""><a href="/en/help" target="_self">Help</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/relay" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Migration Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/introduction-to-relay">Introduction to Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/installation-and-setup">Installation and Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/quick-start-guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/graphql-in-relay">GraphQL in Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-environment">Relay Environment</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/network-layer">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/query-renderer">QueryRenderer</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/fragment-container">Fragment Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/refetch-container">Refetch Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/pagination-container">Pagination Container</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/mutations">Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/subscriptions">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-store">Relay Store</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/routing">Routing</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/graphql-server-specification">GraphQL Server Specification</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Migration Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/new-in-relay-modern">New in Relay Modern</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/relay-compat">Compatibility Mode</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/migration-setup">Migration Setup</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/conversion-playbook">Conversion Playbook</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/conversion-scripts">Conversion Scripts</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/upgrading-setvariables">Upgrading setVariables</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/v1.4.1/converting-mutations">Converting Mutations</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/compatibility-cheatsheet">Compatibility Cheatsheet</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/api-cheatsheet">API Cheatsheet</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Principles &amp; Architecture<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/thinking-in-graphql">Thinking in GraphQL</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/thinking-in-relay">Thinking In Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/architecture-overview">Architecture Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/compiler-architecture">Compiler Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/runtime-architecture">Runtime Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/en/v1.4.1/videos">Videos</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/relay/edit/master/docs/Modern-ConvertingMutations.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Converting Mutations</h1></header><article><div><span><p>We made some changes to how mutations work in the new version of Relay in order to makes them more straight forward to use and more customizable. Mutations are currently not covered by an automatic conversion and require a manual upgrade. However, limited number of changes is needed to make your existing mutations work with both the old and new environment.</p>
<h2><a class="anchor" aria-hidden="true" id="simplifying-fatqueries-to-standard-graphql-queries"></a><a href="#simplifying-fatqueries-to-standard-graphql-queries" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simplifying FatQueries to Standard GraphQL Queries</h2>
<p>FatQueries in Relay Classic mutations was a concept that was confusing for a number of people. It required Relay to keep track of a significant amount of metadata regarding each record and automatically figure out the query to send to the server for the mutation. The logic to deduce the queries to send to the server was both complicated to maintain and slow to run. On top of that, we often had questions about why a particular field is included or skipped. We decided to allow people to have more control by allowing them write out exactly what data they want to update as the result of a mutation. Both individual fields and fragments can be included in these queries. Similar to container fragments, this is subjected to masking. That means only fields listed out directly will be accessible in the callbacks and the updater functions. The data fetched by in referenced fragments will still be updated in the store.</p>
<p>Example of existing fat query:</p>
<pre><code class="hljs css language-javascript">  RelayClassic.QL<span class="hljs-string">`
    fragment on MarkReadNotificationResponsePayload @relay(pattern: true) {
      notification
    }
  `</span>;
</code></pre>
<p>Example of converted mutation query:</p>
<pre><code class="hljs css language-javascript">graphql<span class="hljs-string">`
  mutation MarkReadNotificationMutation(
    $input: MarkReadNotificationData!
  ) {
    markReadNotification(data: $input) {
      notification {
        seenState # include fields to be updated
        ... MyNotificationComponent_notification # reuse fragments from components to be updated
      }
    }
  }
`</span>;
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="migrating-configs"></a><a href="#migrating-configs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migrating Configs</h2>
<h3><a class="anchor" aria-hidden="true" id="fields_change"></a><a href="#fields_change" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FIELDS_CHANGE</h3>
<p>This is no longer needed in Compatibility Mode for neither environments. Relay will normalized the data using the mutation query and id to update the store automatically. You can remove it completely.</p>
<h3><a class="anchor" aria-hidden="true" id="range_add"></a><a href="#range_add" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANGE_ADD</h3>
<p><code>RANGE_ADD</code> needs one additional property in the config named <code>connectionInfo</code> to work with the new environment. Learn more about <code>connectionInfo</code> <a href="mutations.html#range-add">Mutation/RANGE_ADD</a></p>
<h3><a class="anchor" aria-hidden="true" id="range_delete"></a><a href="#range_delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANGE_DELETE</h3>
<p><code>RANGE_DELETE</code> needs one additional property in the config named <code>connectionKeys</code> to work with the new environment. Learn more about <code>connectionKeys</code> <a href="mutations.html#range-delete">Mutation/RANGE_DELETE</a></p>
<h3><a class="anchor" aria-hidden="true" id="node_delete"></a><a href="#node_delete" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>NODE_DELETE</h3>
<p><code>NODE_DELETE</code> config will work as-is with the new environment. No change is needed.</p>
<h2><a class="anchor" aria-hidden="true" id="converting-a-simple-mutation"></a><a href="#converting-a-simple-mutation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting a Simple Mutation</h2>
<p>Take this example of a simple mutation in Relay Classic:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LikeStoryMutation</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RelayClassic</span>.<span class="hljs-title">Mutation</span> </span>{
  <span class="hljs-function"><span class="hljs-title">getMutation</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> RelayClassic.QL<span class="hljs-string">`mutation {likeStory}`</span>;
  }

  <span class="hljs-function"><span class="hljs-title">getVariables</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">storyID</span>: <span class="hljs-built_in">this</span>.props.story.id};
  }

  <span class="hljs-function"><span class="hljs-title">getFatQuery</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> RelayClassic.QL<span class="hljs-string">`
      fragment on LikeStoryPayload @relay(pattern: true) {
        story {
          likers,
          likeSentence,
          viewerDoesLike,
        },
      }
    `</span>;
  }

  <span class="hljs-function"><span class="hljs-title">getConfigs</span>(<span class="hljs-params"></span>)</span> {
    <span class="hljs-keyword">return</span> [{
      <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;FIELDS_CHANGE&#x27;</span>,
      <span class="hljs-attr">fieldIDs</span>: {
        <span class="hljs-attr">story</span>: <span class="hljs-built_in">this</span>.props.story.id,
      },
    }];
  }

  <span class="hljs-keyword">static</span> fragments = {
    <span class="hljs-attr">story</span>: <span class="hljs-function">() =&gt;</span> Relay.QL<span class="hljs-string">`
      fragment on Story {
        id
      }
    `</span>,
  };
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="converting-getmutation-and-getfatquery"></a><a href="#converting-getmutation-and-getfatquery" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting <code>getMutation()</code> and <code>getFatQuery()</code></h3>
<p>We combine these two into a regular GraphQL mutation, which list out specific fields that needs to be updated.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation LikeStoryMutation($input: LikeStoryData!) {
    story(data: $input) {
      likers {
        count
      }
      likeSentence
      viewerDoesLike
    }
  }
`</span>;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="converting-getconfigs"></a><a href="#converting-getconfigs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting <code>getConfigs()</code></h3>
<p>As specified above, <code>FIELDS_CHANGE</code> configs can be omitted.</p>
<h3><a class="anchor" aria-hidden="true" id="converting-getvariables"></a><a href="#converting-getvariables" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting <code>getVariables()</code></h3>
<p>To convert <code>getVariables()</code>, we take the return value from the original function and wrap it in an object that contains a property that matches the variable name for the mutation. In this case, the mutation has a <code>input</code> variable that is of type <code>LikeStoryData</code>.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> variables = {
  <span class="hljs-attr">input</span>: {
    <span class="hljs-attr">storyID</span>: args.storyID
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="final-result"></a><a href="#final-result" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final Result</h3>
<p>As you can see, our resulting mutation is a lot simpler and more like regular GraphQL than the Relay Classic version we started out with.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> mutation = graphql<span class="hljs-string">`
  mutation LikeStoryMutation($input: LikeStoryData!) {
    story {
      likers {
        count
      },
      likeSentence,
      viewerDoesLike
    }
  }
`</span>;

<span class="hljs-comment">// environment should be passed in from your component as this.props.relay.environment</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">commit</span>(<span class="hljs-params">environment: CompatEnvironment, args</span>) </span>{
  <span class="hljs-keyword">const</span> variables = {
    <span class="hljs-attr">input</span>: {
      <span class="hljs-attr">storyID</span>: args.storyID
    }
  };

  <span class="hljs-keyword">return</span> commitMutation(environment, {
    mutation,
    variables,
  });
}
</code></pre>
<p>See <a href="mutations.html">Mutation</a> for additional options on <code>commitMutation</code> for more complex mutations.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 12/19/2017 by Yuzhi Zheng</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/v1.4.1/upgrading-setvariables"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/docs/en/v1.4.1/compatibility-cheatsheet"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#simplifying-fatqueries-to-standard-graphql-queries">Simplifying FatQueries to Standard GraphQL Queries</a></li><li><a href="#migrating-configs">Migrating Configs</a><ul class="toc-headings"><li><a href="#fields_change">FIELDS_CHANGE</a></li><li><a href="#range_add">RANGE_ADD</a></li><li><a href="#range_delete">RANGE_DELETE</a></li><li><a href="#node_delete">NODE_DELETE</a></li></ul></li><li><a href="#converting-a-simple-mutation">Converting a Simple Mutation</a><ul class="toc-headings"><li><a href="#converting-getmutation-and-getfatquery">Converting <code>getMutation()</code> and <code>getFatQuery()</code></a></li><li><a href="#converting-getconfigs">Converting <code>getConfigs()</code></a></li><li><a href="#converting-getvariables">Converting <code>getVariables()</code></a></li><li><a href="#final-result">Final Result</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/relay.svg" alt="Relay" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/introduction-to-relay.html">Introduction</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a></div><div><h5>More</h5><a href="https://github.com/facebook/relay">GitHub</a><a href="https://opensource.facebook.com/legal/terms">Terms of Use</a><a href="https://opensource.facebook.com/legal/privacy">Privacy Policy</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2021 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '3d7d5825d50ea36bca0e6ad06c926f06',
                indexName: 'relay',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:v1.4.1"]}
              });
            </script></body></html>