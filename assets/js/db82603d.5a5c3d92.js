"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[96038],{3905:(e,t,n)=>{n.r(t),n.d(t,{MDXContext:()=>c,MDXProvider:()=>p,mdx:()=>f,useMDXComponents:()=>d,withMDXComponents:()=>u});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),u=function(e){return function(t){var n=d(t.components);return r.createElement(e,o({},t,{components:n}))}},d=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return r.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,a=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),p=i,h=u["".concat(a,".").concat(p)]||u[p]||m[p]||o;return n?r.createElement(h,s(s({ref:t},c),{},{components:n})):r.createElement(h,s({ref:t},c))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<o;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},25961:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var r=n(83117),i=n(80102),o=(n(67294),n(3905)),a=["components"],s={id:"production",title:"Production Setup",slug:"/getting-started/production/",description:"Setting up Relay for production use",keywords:["production"]},l=void 0,c={unversionedId:"getting-started/production",id:"version-v20.0.0/getting-started/production",title:"Production Setup",description:"Setting up Relay for production use",source:"@site/versioned_docs/version-v20.0.0/getting-started/production.md",sourceDirName:"getting-started",slug:"/getting-started/production/",permalink:"/docs/v20.0.0/getting-started/production/",draft:!1,editUrl:"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v20.0.0/getting-started/production.md",tags:[],version:"v20.0.0",frontMatter:{id:"production",title:"Production Setup",slug:"/getting-started/production/",description:"Setting up Relay for production use",keywords:["production"]},sidebar:"docs",previous:{title:"Editor Support",permalink:"/docs/v20.0.0/editor-support/"},next:{title:"Tutorial Intro",permalink:"/docs/v20.0.0/tutorial/intro"}},u={},d=[{value:"Persisted Queries (Trusted Documents)",id:"persisted-queries-trusted-documents",level:2},{value:"Relay Lint Rules",id:"relay-lint-rules",level:2},{value:"Running the Relay Compiler in CI",id:"running-the-relay-compiler-in-ci",level:2}],p={toc:d};function m(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.mdx)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("p",null,"Getting the most out of Relay in production requires a few extra steps. This page covers a list of best practices for taking Relay to production."),(0,o.mdx)("h2",{id:"persisted-queries-trusted-documents"},"Persisted Queries (Trusted Documents)"),(0,o.mdx)("p",null,"One of GraphQL's key innovations is that it enables clients to define arbitrary queries. While this unlocks a lot of flexibility, it also opens the doors to abuse. Scrapers can use GraphQL to scrape data from your site, and malicious users can use GraphQL to send large requests to your server that cause a denial of service. To prevent this, we recommend using ",(0,o.mdx)("a",{parentName:"p",href:"/docs/v20.0.0/guides/persisted-queries/"},"Persisted Queries")," also know as ",(0,o.mdx)("a",{parentName:"p",href:"https://benjie.dev/graphql/trusted-documents"},"Trusted Documents"),"."),(0,o.mdx)("p",null,"With Persisted Queries, the set of queries that the client can send is locked in at build time. This means that scrapers and malicious attackers are limited to sending only the queries used by the client, just like REST. It also has the added benefit that the client code only needs to include an single id for each query rather than the whole query text."),(0,o.mdx)("h2",{id:"relay-lint-rules"},"Relay Lint Rules"),(0,o.mdx)("p",null,"A key principal of Relay is data colocation where each component defines its own data dependencies. It's critical to ",(0,o.mdx)("a",{parentName:"p",href:"https://relay.dev/blog/2023/10/24/how-relay-enables-optimal-data-fetching/"},"How Relay Enables Optimal Data Fetching"),". However, this is often unintuitive for developers who are used to fetching data in a single query. Relay's ESLint rules can help enforce this pattern by ensuring no component fetches fields which it does not itself use."),(0,o.mdx)("p",null,"We recommend using the ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/relayjs/eslint-plugin-relay"},(0,o.mdx)("inlineCode",{parentName:"a"},"eslint-plugin-relay")),", especially the ",(0,o.mdx)("inlineCode",{parentName:"p"},"relay/unused-fields")," rule."),(0,o.mdx)("p",null,"Learn how to install them: ",(0,o.mdx)("a",{parentName:"p",href:"/docs/v20.0.0/getting-started/lint-rules/"},"Relay ESLint Plugin"),"."),(0,o.mdx)("h2",{id:"running-the-relay-compiler-in-ci"},"Running the Relay Compiler in CI"),(0,o.mdx)("p",null,"We recommend committing Relay's generated artifacts to source control along with your application code. This ensures generated types are present without needing an additional build, and allows for inspection of generated artifacts in code review. To ensure the generated artifacts are always in sync with the source code, we recommend running the Relay compiler in CI and ensuring it does not change any generated files. A example bash script which checks for changes can be found ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/facebook/relay/blob/0414c9ad0744483e349e07defcb6d70a52cf8b3c/scripts/check-git-status.sh"},"here"),"."))}m.isMDXComponent=!0}}]);