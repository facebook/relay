<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Relay | A JavaScript framework for building data-driven React applications</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Relay | A JavaScript framework for building data-driven React applications"><meta property="og:type" content="website"><meta property="og:url" content="http://facebook.github.io/relay/index.html"><meta property="og:description" content="A JavaScript framework for building data-driven React applications"><link rel="shortcut icon" href="/relay/img/favicon.png"><link rel="stylesheet" href="/relay/css/relay.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/relay/"><img class="nav-logo" src="/relay/img/logo.svg" width="50" height="50">Relay</a><ul class="nav-site"><li><a href="/relay/docs/getting-started.html#content" class="active">Docs</a></li><li><a href="/relay/support.html" class="">Support</a></li><li><a href="https://github.com/facebook/relay" class="">GitHub</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/getting-started.html#content">Getting Started</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/tutorial.html#content">Tutorial</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/videos.html#content">Videos</a></li></ul></div><div class="nav-docs-section"><h3>Guides</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/guides-containers.html#content">Containers</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-routes.html#content">Routes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-root-container.html#content">Root Container</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-ready-state.html#content">Ready State</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-mutations.html#content">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-network-layer.html#content">Network Layer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-babel-plugin.html#content">Babel Relay Plugin</a></li></ul></div><div class="nav-docs-section"><h3>GraphQL</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-relay-specification.html#content">GraphQL Relay Specification</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/graphql-object-identification.html#content">Object Identification</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/graphql-connections.html#content">Connection</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/graphql-mutations.html#content">Mutations</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/graphql-further-reading.html#content">Further Reading</a></li></ul></div><div class="nav-docs-section"><h3>API Reference</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay.html#content">Relay</a></li><li><a style="margin-left:0;" class="active" href="/relay/docs/api-reference-relay-container.html#content">RelayContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-route.html#content">Relay.Route</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-root-container.html#content">Relay.RootContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-ql.html#content">Relay.QL</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-mutation.html#content">Relay.Mutation</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-proptypes.html#content">Relay.PropTypes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-store.html#content">Relay.Store</a></li></ul></div><div class="nav-docs-section"><h3>Interfaces</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-network-layer.html#content">RelayNetworkLayer</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/interfaces-relay-mutation-request.html#content">RelayMutationRequest</a></li><li><a style="margin-left:20px;" class="" href="/relay/docs/interfaces-relay-query-request.html#content">RelayQueryRequest</a></li></ul></div></div><div class="inner-content"><a id="content"></a><a class="edit-page-link" href="https://github.com/facebook/relay/blob/master/docs/APIReference-Container.md" target="_blank">Edit on GitHub</a><h1>RelayContainer</h1><div><p><code>RelayContainer</code> is a higher-order React component that lets a React component encode its data requirements.</p><ul><li>Relay ensures that this data is available before the component is rendered.</li><li>Updates will be sent to the component whenever the underlying data has changed.</li></ul><p>Relay containers are created using <code>Relay.createContainer</code>.</p><h2><a class="anchor" name="overview"></a>Overview <a class="hash-link" href="#overview">#</a></h2><p><em>Container Specification</em></p><div><ul class="apiIndex">
  <li>
    <a href="#fragments">
      <pre>fragments</pre>
      Declare the component's data requirements using fragments.
    </a>
  </li>
  <li>
    <a href="#initialvariables">
      <pre>initialVariables</pre>
      The initial set of variable values available to this component's fragments.
    </a>
  </li>
  <li>
    <a href="#preparevariables">
      <pre>prepareVariables</pre>
      A method to modify the variables based on the runtime environment or previous variable values.
    </a>
  </li>
</ul>

</div><p><em>Properties and Methods</em></p><p>These are the methods and properties that the container will provide as <code>this.props.relay</code> in the plain React component.</p><div><ul class="apiIndex">
  <li>
    <a href="#route">
      <pre>route</pre>
    </a>
  </li>
  <li>
    <a href="#variables">
      <pre>variables</pre>
    </a>
  </li>
  <li>
    <a href="#setvariables">
      <pre>setVariables([partialVariables, [onReadyStateChange]])</pre>
    </a>
  </li>
  <li>
    <a href="#forcefetch">
      <pre>forceFetch([partialVariables, [onReadyStateChange]]) </pre>
    </a>
  </li>
  <li>
    <a href="#hasoptimisticupdate">
      <pre>hasOptimisticUpdate(record)</pre>
    </a>
  </li>
  <li>
    <a href="#getpendingtransactions">
      <pre>getPendingTransactions(record) </pre>
    </a>
  </li>
</ul>

</div><h2><a class="anchor" name="container-specification"></a>Container Specification <a class="hash-link" href="#container-specification">#</a></h2><h3><a class="anchor" name="fragments"></a>fragments <a class="hash-link" href="#fragments">#</a></h3><pre class="prism language-javascript">fragments<span class="token punctuation">:</span> RelayQueryFragments<span class="token operator">&lt;</span>Tk<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>propName<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>
    variables<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> mixed<span class="token punctuation">}</span>
  <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL<span class="token template-string"><span class="token string">`fragment on ...`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><p>Containers declare data requirements on <code>fragments</code> using GraphQL fragments.</p><p>Only fields specified by these fragments will be populated in <code>this.props</code> when the component is rendered. This ensures that there are no implicit dependencies from a component on its parent component or any child components.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">StarWarsShip</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>ship<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>StarWarsShip<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    ship<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL<span class="token template-string"><span class="token string">`
      fragment on Ship {
        name
      }
    `</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-highlight" style="height:20px;top:140px;"></div><div class="line-highlight" style="height:20px;top:160px;"></div><div class="line-highlight" style="height:20px;top:180px;"></div><div class="line-highlight" style="height:20px;top:200px;"></div><div class="line-highlight" style="height:20px;top:220px;"></div><div class="line-highlight" style="height:20px;top:240px;"></div><div class="line-highlight" style="height:20px;top:260px;"></div></pre><p>In this example, the fields associated with the <code>ship</code> fragment will be made available on <code>this.props.ship</code>.</p><p>See also: <a href="guides-containers.html#relay-containers" target="_blank">Containers &gt; Relay Containers</a></p><h3><a class="anchor" name="initialvariables"></a>initialVariables <a class="hash-link" href="#initialvariables">#</a></h3><pre class="prism language-javascript">initialVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> mixed<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><p>The initial set of variable values available to this component&#x27;s fragments.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">ProfilePicture</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>ProfilePicture<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  initialVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span>size<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL<span class="token template-string"><span class="token string">`
      # The variable defined above is available here as `</span></span>$size<span class="token template-string"><span class="token string">`.
      fragment on User { profilePicture(size: $size) { ... } }
    `</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-highlight" style="height:20px;top:60px;"></div></pre><p>In this example, <code>profilePicture(size: 50)</code> will be fetched for the intial render.</p><h3><a class="anchor" name="preparevariables"></a>prepareVariables <a class="hash-link" href="#preparevariables">#</a></h3><pre class="prism language-javascript">prepareVariables<span class="token punctuation">:</span> <span class="token operator">?</span><span class="token punctuation">(</span>
  prevVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> mixed<span class="token punctuation">}</span>
<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> mixed<span class="token punctuation">}</span></pre><p>Containers can define a <code>prepareVariables</code> method which provides the opportunity to modify the variables that are available to fragments. The new variables can be generated based on the previous variables (or the <code>initialVariables</code> if no previous ones exist) in addition to the runtime environment.</p><p>This method is also called after the partial set of variables from <code>setVariables</code> has been applied. The variables returned are used to populate the fragments.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>ProfilePicture<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> initialVariables <span class="token operator">=</span> <span class="token punctuation">{</span>size<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> prepareVariables <span class="token operator">=</span> prevVariables <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>prevVariables<span class="token punctuation">,</span>
      <span spellcheck="true" class="token comment">// If devicePixelRatio is `2`, the new size will be `100`.</span>
      size<span class="token punctuation">:</span> prevVariables<span class="token punctuation">.</span>size <span class="token operator">*</span> window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span spellcheck="true" class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-highlight" style="height:20px;top:40px;"></div><div class="line-highlight" style="height:20px;top:60px;"></div><div class="line-highlight" style="height:20px;top:80px;"></div><div class="line-highlight" style="height:20px;top:100px;"></div><div class="line-highlight" style="height:20px;top:120px;"></div><div class="line-highlight" style="height:20px;top:140px;"></div><div class="line-highlight" style="height:20px;top:160px;"></div></pre><h2><a class="anchor" name="properties-and-methods"></a>Properties and Methods <a class="hash-link" href="#properties-and-methods">#</a></h2><p>The properties and methods listed below can be accessed on <code>this.props.relay</code> from the wrapped React component.</p><h3><a class="anchor" name="route"></a>route <a class="hash-link" href="#route">#</a></h3><pre class="prism language-javascript">route<span class="token punctuation">:</span> RelayRoute</pre><p>Route is useful in providing the context which a component is being rendered in. It includes information about the <code>name</code>, <code>params</code>, and <code>queries</code> of the current route.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span>route<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">&#x27;SuperAwesomeRoute&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span spellcheck="true" class="token comment">// Do something super cool.</span>
<span class="token punctuation">}</span></pre><p>See also: <a href="guides-routes.html" target="_blank">Routes</a></p><h3><a class="anchor" name="variables"></a>variables <a class="hash-link" href="#variables">#</a></h3><pre class="prism language-javascript">variables<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> mixed<span class="token punctuation">}</span></pre><p><code>variables</code> contains the set of variables that was used to fetch the current set of props.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">ProfilePicture</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>View<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Image
          uri<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>profilePicture<span class="token punctuation">.</span>uri<span class="token punctuation">}</span>
          width<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span>variables<span class="token punctuation">.</span>size<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>ProfilePicture<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  initialVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span>size<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL<span class="token template-string"><span class="token string">`
      fragment on User { profilePicture(size: $size) { ... } }
    `</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-highlight" style="height:20px;top:140px;"></div></pre><p>In this example, the <code>width</code> of the rendered image will always correspond to the <code>$size</code> variable used to fetch the current version of <code>profilePicture.uri</code>.</p><blockquote><p>Note</p><p>Never mutate <code>this.props.relay.variables</code> directly as it will not trigger data to be fetched properly. Treat <code>this.props.relay.variables</code> as if it were immutable, just like props.</p></blockquote><h3><a class="anchor" name="setvariables"></a>setVariables <a class="hash-link" href="#setvariables">#</a></h3><pre class="prism language-javascript"><span class="token function">setVariables</span><span class="token punctuation">(</span><span class="token punctuation">[</span>partialVariables<span class="token punctuation">:</span> Object<span class="token punctuation">,</span> <span class="token punctuation">[</span>onReadyStateChange<span class="token punctuation">:</span> Function<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span></pre><p>Components can change their data requirements by using <code>setVariables</code> to request an update to the current set of <code>variables</code>.</p><p><code>this.props.relay.setVariables</code> can be called to update a subset or all of the variables at the same time. In return, Relay will use the new variables to attempt to fulfill the new fragment. This may involve sending a request to the server if data is not already available on the client.</p><p>An optional <code>onReadyStateChange</code> callback can be supplied to respond to the events involved with the data fulfillment.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Feed</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>viewer<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          edge <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>Story story<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">}</span> key<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">.</span>id<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">_handleScrollLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span spellcheck="true" class="token comment">// Increments the number of stories being rendered by 10.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span><span class="token function">setVariables</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      count<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span>variables<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>Feed<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  initialVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    viewer<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL`
      fragment on Viewer <span class="token punctuation">{</span>
        <span class="token function">feed</span><span class="token punctuation">(</span>first<span class="token punctuation">:</span> $count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          edges <span class="token punctuation">{</span>
            node <span class="token punctuation">{</span>
              id<span class="token punctuation">,</span>
              $<span class="token punctuation">{</span>Story<span class="token punctuation">.</span><span class="token function">getFragment</span><span class="token punctuation">(</span><span class="token string">&#x27;story&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    `<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><div class="line-highlight" style="height:20px;top:220px;"></div><div class="line-highlight" style="height:20px;top:240px;"></div><div class="line-highlight" style="height:20px;top:260px;"></div><div class="line-highlight" style="height:20px;top:280px;"></div></pre><blockquote><p>Note</p><p><code>setVariables</code> does not immediately mutate <code>variables</code>, but creates a  pending state transition. <code>variables</code> will continue returning the previous values until <code>this.props</code> has been populated with data that fulfills the new variable values.</p></blockquote><p>See also: <a href="guides-containers.html#requesting-different-data" target="_blank">Containers &gt; Requesting Different Data</a>, <a href="guides-ready-state.html" target="_blank">Ready State</a></p><h3><a class="anchor" name="forcefetch"></a>forceFetch <a class="hash-link" href="#forcefetch">#</a></h3><pre class="prism language-javascript"><span class="token function">forceFetch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>partialVariables<span class="token punctuation">:</span> Object<span class="token punctuation">,</span> <span class="token punctuation">[</span>onReadyStateChange<span class="token punctuation">:</span> Function<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span></pre><p><code>forceFetch</code> is similar to <code>setVariables</code> because it is also used to change the data requirements by altering <code>variables</code>.</p><p>The two methods differ in that instead of sending a query that includes only fields missing from the client, <code>forceFetch</code> sends a request to refetch each and every fragment. This ensures that the props for the component are freshly fetched from the server.</p><p>An optional <code>onReadyStateChange</code> callback can be supplied to respond to the events involved with the data fulfillment.</p><blockquote><p>Note</p><p><code>forceFetch</code> can be called with an empty set of partial variables, meaning it can trigger a refresh of the currently rendered set of data.</p></blockquote><p>See also: <a href="guides-ready-state.html" target="_blank">Ready State</a></p><h3><a class="anchor" name="hasoptimisticupdate"></a>hasOptimisticUpdate <a class="hash-link" href="#hasoptimisticupdate">#</a></h3><pre class="prism language-javascript"><span class="token function">hasOptimisticUpdate</span><span class="token punctuation">(</span>record<span class="token punctuation">:</span> Object<span class="token punctuation">)</span><span class="token punctuation">:</span> boolean</pre><p>Calling <code>hasOptimisticUpdate</code> with a record from <code>this.props</code> will return whether that given record is affected by an optimistic mutation. It allows the component to render local optimistic changes differently from data that has successfully synchronized with the server.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Feed</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> edges <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>viewer<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>edges<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>edges<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>edge <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> node <span class="token operator">=</span> edge<span class="token punctuation">.</span>node<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span><span class="token function">hasOptimisticUpdate</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span spellcheck="true" class="token comment">// Render pending story that has not been stored</span>
            <span spellcheck="true" class="token comment">// on the server using a diffrent component.</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token operator">&lt;</span>PendingStory
                key<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">.</span>id<span class="token punctuation">}</span>
                story<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">}</span>
              <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
              <span class="token operator">&lt;</span>Story
                key<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">.</span>id<span class="token punctuation">}</span>
                story<span class="token operator">=</span><span class="token punctuation">{</span>edge<span class="token punctuation">.</span>node<span class="token punctuation">}</span>
              <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>Feed<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  initialVariables<span class="token punctuation">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    viewer<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL`
      fragment on Viewer <span class="token punctuation">{</span>
        <span class="token function">feed</span><span class="token punctuation">(</span>first<span class="token punctuation">:</span> $count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          edges <span class="token punctuation">{</span>
            node <span class="token punctuation">{</span>
              id<span class="token punctuation">,</span>
              $<span class="token punctuation">{</span>Story<span class="token punctuation">.</span><span class="token function">getFragment</span><span class="token punctuation">(</span><span class="token string">&#x27;story&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
              $<span class="token punctuation">{</span>PendingStory<span class="token punctuation">.</span><span class="token function">getFragment</span><span class="token punctuation">(</span><span class="token string">&#x27;story&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    `<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>See also: <a href="guides-mutations.html#optimistic-updates" target="_blank">Mutations &gt; Optimistic Updates</a></p><h3><a class="anchor" name="getpendingtransactions"></a>getPendingTransactions <a class="hash-link" href="#getpendingtransactions">#</a></h3><pre class="prism language-javascript"><span class="token function">getPendingTransactions</span><span class="token punctuation">(</span>record<span class="token punctuation">:</span> Object<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>RelayMutationTransaction<span class="token operator">&gt;</span></pre><p>Components can inspect pending mutations on any record (i.e. data made available in props with a corresponding fragment). Calling <code>getPendingTransactions</code> with a record will return a list of the pending mutation transactions that affect that particular record.</p><p>Each <code>RelayMutationTransaction</code> has methods to check the status of the mutation and provide ways to rollback or resend the mutation as needed.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Story</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> story <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>story<span class="token punctuation">;</span>
    <span class="token keyword">var</span> transactions <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>relay<span class="token punctuation">.</span><span class="token function">getPendingTransactions</span><span class="token punctuation">(</span>story<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span spellcheck="true" class="token comment">// For this example, assume there is only one transaction.</span>
    <span class="token keyword">var</span> transaction <span class="token operator">=</span> transactions <span class="token operator">?</span> transactions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>transaction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span spellcheck="true" class="token comment">// Display an error message with a retry link if a mutation failed.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transaction<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#x27;COMMIT_FAILED&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>
            This story failed to post<span class="token punctuation">.</span>
            <span class="token operator">&lt;</span>a onClick<span class="token operator">=</span><span class="token punctuation">{</span>transaction<span class="token punctuation">.</span>recommit<span class="token punctuation">}</span><span class="token operator">&gt;</span>Try Again<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span spellcheck="true" class="token comment">// Render story normally.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Relay<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span>ProfilePicture<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  fragments<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    story<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Relay<span class="token punctuation">.</span>QL<span class="token template-string"><span class="token string">`
      fragment on story {
        # ...
      }
    `</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p><code>RelayMutationTransaction.getStatus</code> can return one of the following strings:</p><ul><li><code>UNCOMMITTED</code> — Transaction hasn&#x27;t yet been sent to the server. Transaction can be committed or rolled back.</li><li><code>COMMIT_QUEUED</code> —  Transaction was committed but another transaction with the same collision key is pending, so the transaction has been queued to send to the server.</li><li><code>COLLISION_COMMIT_FAILED</code> — Transaction was queued for commit but another transaction with the same collision key failed. All transactions in the collision queue, including this one, have been failed. Transaction can be recommitted or rolled back.</li><li><code>COMMITTING</code> — Transaction is waiting for the server to respond.</li><li><code>COMMIT_FAILED</code> — Transaction was sent to the server for comitting but failed.</li></ul></div><div class="docs-prevnext"><a class="docs-next" href="api-reference-relay-route.html#content">Next →</a></div></div></section><footer class="wrap"><div class="right">©2015 Facebook Inc.</div></footer></div><div id="fb-root"></div><script>
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          </script></body></html>