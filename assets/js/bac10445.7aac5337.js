"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["10930"],{95889(e,t,s){s.r(t),s.d(t,{metadata:()=>n,default:()=>u,frontMatter:()=>r,contentTitle:()=>o,toc:()=>d,assets:()=>l});var n=JSON.parse('{"id":"guided-tour/reusing-cached-data/fetch-policies","title":"Fetch Policies","description":"Relay guide to fetch policies","source":"@site/versioned_docs/version-v20.0.0/guided-tour/reusing-cached-data/fetch-policies.md","sourceDirName":"guided-tour/reusing-cached-data","slug":"/guided-tour/reusing-cached-data/fetch-policies/","permalink":"/docs/v20.0.0/guided-tour/reusing-cached-data/fetch-policies/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v20.0.0/guided-tour/reusing-cached-data/fetch-policies.md","tags":[],"version":"v20.0.0","frontMatter":{"id":"fetch-policies","title":"Fetch Policies","slug":"/guided-tour/reusing-cached-data/fetch-policies/","description":"Relay guide to fetch policies","keywords":["fetch policy","network-only","store-only","store-and-network","store-or-network"]},"sidebar":"docs","previous":{"title":"Reusing Cached Data","permalink":"/docs/v20.0.0/guided-tour/reusing-cached-data/"},"next":{"title":"Presence of Data","permalink":"/docs/v20.0.0/guided-tour/reusing-cached-data/presence-of-data/"}}'),a=s(74848),i=s(28453),c=s(86898);s(17352);let r={id:"fetch-policies",title:"Fetch Policies",slug:"/guided-tour/reusing-cached-data/fetch-policies/",description:"Relay guide to fetch policies",keywords:["fetch policy","network-only","store-only","store-and-network","store-or-network"]},o,l={},d=[];function h(e){let t={a:"a",code:"code",em:"em",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["The first step to reusing locally cached data is to pass a ",(0,a.jsx)(t.code,{children:"fetchPolicy"})," to the ",(0,a.jsx)(t.code,{children:"loadQuery"})," function, which can be provided by ",(0,a.jsx)(t.code,{children:"useQueryLoader"})," (see the ",(0,a.jsx)(t.a,{href:"../../rendering/queries/",children:"Fetching Queries section"}),"):"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"const React = require('React');\nconst {graphql} = require('react-relay');\n\nfunction AppTabs() {\n  const [\n    queryRef,\n    loadQuery,\n  ] = useQueryLoader(HomeTabQuery);\n\n  const onSelectHomeTab = () => {\n    loadQuery({id: '4'}, {fetchPolicy: 'store-or-network'});\n  }\n\n  // ...\n}\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The provided ",(0,a.jsx)(t.code,{children:"fetchPolicy"})," will determine:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"whether"})," the query should be fulfilled from the local cache, and"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"whether"})," a network request should be made to fetch the query from the server, depending on the availability of the data for that query in the store."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["By default, Relay will try to read the query from the local cache; if any piece of data for that query is ",(0,a.jsx)(t.a,{href:"../presence-of-data/",children:"missing"})," or ",(0,a.jsx)(t.a,{href:"../staleness-of-data/",children:"stale"}),", it will fetch the entire query from the network. This default ",(0,a.jsx)(t.code,{children:"fetchPolicy"}),' is called "',(0,a.jsx)(t.em,{children:'store-or-network".'})]}),"\n",(0,a.jsxs)(t.p,{children:["Specifically, ",(0,a.jsx)(t.code,{children:"fetchPolicy"})," can be any of the following options: **"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:['"store-or-network": ',(0,a.jsx)(t.em,{children:"(default)"})," ",(0,a.jsx)(t.em,{children:"will"})," reuse locally cached data, and will ",(0,a.jsx)(t.em,{children:"only"})," send a network request if any data for the query is ",(0,a.jsx)(t.a,{href:"../presence-of-data/",children:"missing"})," or ",(0,a.jsx)(t.a,{href:"../staleness-of-data/",children:"stale"}),". If the query is fully cached, a network request will ",(0,a.jsx)(t.em,{children:"not"})," be made."]}),"\n",(0,a.jsxs)(t.li,{children:['"store-and-network": ',(0,a.jsx)(t.em,{children:"will"})," reuse locally cached data and will ",(0,a.jsx)(t.em,{children:"always"})," send a network request, regardless of whether any data was ",(0,a.jsx)(t.a,{href:"../presence-of-data/",children:"missing"})," or ",(0,a.jsx)(t.a,{href:"../staleness-of-data/",children:"stale"})," in the store."]}),"\n",(0,a.jsxs)(t.li,{children:['"network-only": ',(0,a.jsx)(t.em,{children:"will"})," ",(0,a.jsx)(t.em,{children:"not"})," reuse locally cached data, and will ",(0,a.jsx)(t.em,{children:"always"})," send a network request to fetch the query, ignoring any data that might be locally cached and whether it's ",(0,a.jsx)(t.a,{href:"../presence-of-data/",children:"missing"})," or ",(0,a.jsx)(t.a,{href:"../staleness-of-data/",children:"stale"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:['"store-only": ',(0,a.jsx)(t.em,{children:"will"})," ",(0,a.jsx)(t.em,{children:"only"})," reuse locally cached data, and will ",(0,a.jsx)(t.em,{children:"never"})," send a network request to fetch the query. In this case, the responsibility of fetching the query falls to the caller, but this policy could also be used to read and operate on data that is entirely ",(0,a.jsx)(t.a,{href:"../../updating-data/local-data-updates/",children:"local"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["Note that the ",(0,a.jsx)(t.code,{children:"refetch"})," function discussed in the ",(0,a.jsx)(t.a,{href:"/docs/v20.0.0/guided-tour/list-data/introduction",children:"Fetching and Rendering Different Data"})," section also takes a ",(0,a.jsx)(t.code,{children:"fetchPolicy"}),"."]}),"\n",(0,a.jsx)(c.A,{})]})}function u(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},86898(e,t,s){s.d(t,{A:()=>p});var n=s(74848),a=s(95310),i=s(17352),c=s(96540);function r(){let e=window.encodeURI(JSON.stringify({title:"Feedback about "+window.location.pathname,description:"**!!! Required !!!**\n\nPlease modify the task description to let us know how the docs can be improved.\n\n**Please do not ask support questions via this form! Instead, ask in fburl.com/relay_support**",tag_ids:{add:[0xac96423e5b680,0x64079768ac750]}}));window.open("https://www.internalfb.com/tasks/?n="+e)}function o({children:e}){return(0,n.jsxs)("div",{className:"docsRating",id:"docsRating",children:[(0,n.jsx)("hr",{}),e]})}let l=()=>{let[e,t]=c.useState(!1),s=e=>{t(!0),window.ga&&window.ga("send",{hitType:"event",eventCategory:"button",eventAction:"feedback",eventValue:e})};return e?"Thank you for letting us know!":(0,n.jsxs)(n.Fragment,{children:["Is this page useful?",(0,n.jsx)("svg",{className:"i_thumbsup",alt:"Like",id:"docsRating-like",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>s(1),children:(0,n.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})}),(0,n.jsx)("svg",{className:"i_thumbsdown",alt:"Dislike",id:"docsRating-dislike",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 81.13 89.76",onClick:()=>s(0),children:(0,n.jsx)("path",{d:"M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"})})]})},d=()=>(0,n.jsxs)("p",{children:["Let us know how these docs can be improved by",(0,n.jsx)("a",{className:"button",role:"button",tabIndex:0,onClick:r,children:"Filing a task"})]}),h=()=>(0,n.jsxs)("p",{children:["Help us make the site even better by"," ",(0,n.jsx)(a.default,{to:"https://www.surveymonkey.com/r/FYC9TCJ",children:"answering a few quick questions"}),"."]}),u=()=>(0,n.jsxs)(o,{children:[(0,n.jsx)(d,{}),(0,n.jsx)(l,{}),(0,n.jsx)(h,{})]}),f=()=>(0,n.jsxs)(o,{children:[(0,n.jsx)(l,{}),(0,n.jsx)(h,{})]}),p=()=>(0,i.fbContent)({internal:(0,n.jsx)(u,{}),external:(0,n.jsx)(f,{})})},28453(e,t,s){s.d(t,{R:()=>c,x:()=>r});var n=s(96540);let a={},i=n.createContext(a);function c(e){let t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);