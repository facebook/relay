<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v19.0.0 plugin-docs plugin-id-default docs-doc-id-guides/data-driven-dependencies/server-3d" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Server 3D | Relay</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://relay.dev/img/relay.png"><meta data-rh="true" name="twitter:image" content="https://relay.dev/img/relay.png"><meta data-rh="true" property="og:url" content="https://relay.dev/docs/v19.0.0/guides/data-driven-dependencies/server-3d/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v19.0.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v19.0.0"><meta data-rh="true" name="docsearch:version" content="v19.0.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v19.0.0"><meta data-rh="true" property="og:title" content="Server 3D | Relay"><meta data-rh="true" name="description" content="Server side data driven dependencies (3D)"><meta data-rh="true" property="og:description" content="Server side data driven dependencies (3D)"><meta data-rh="true" name="keywords" content="3D,Server 3D,data driven dependencies,module,match,MatchContainer"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://relay.dev/docs/v19.0.0/guides/data-driven-dependencies/server-3d/"><link data-rh="true" rel="alternate" href="https://relay.dev/docs/v19.0.0/guides/data-driven-dependencies/server-3d/" hreflang="en"><link data-rh="true" rel="alternate" href="https://relay.dev/docs/v19.0.0/guides/data-driven-dependencies/server-3d/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UBPJPW35NS-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Relay RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Relay Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-DCSC7FDGL5","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DCSC7FDGL5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DCSC7FDGL5",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Relay" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.3fffda90.css">
<link rel="preload" href="/assets/js/runtime~main.de535efd.js" as="script">
<link rel="preload" href="/assets/js/main.509dd6b3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>

<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Relay</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/help/">Help</a><a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/v19.0.0/">v19.0.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/guides/data-driven-dependencies/server-3d/">Next ðŸš§</a></li><li><a class="dropdown__link" href="/docs/guides/data-driven-dependencies/server-3d/">v20.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/v19.0.0/guides/data-driven-dependencies/server-3d/">v19.0.0</a></li><li><a class="dropdown__link" href="/docs/v18.0.0/">v18.0.0</a></li><li><a class="dropdown__link" href="/docs/v17.0.0/">v17.0.0</a></li><li><a class="dropdown__link" href="/docs/v16.0.0/">v16.0.0</a></li><li><a class="dropdown__link" href="/docs/v15.0.0/">v15.0.0</a></li><li><a class="dropdown__link" href="/docs/v14.0.0/">v14.0.0</a></li><li><a class="dropdown__link" href="/docs/v13.0.0/">v13.0.0</a></li><li><a class="dropdown__link" href="/versions/">All versions</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Relay<!-- --> <b>v19.0.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/guides/data-driven-dependencies/server-3d/">latest version</a></b> (<!-- -->v20.0.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><span class="theme-doc-version-badge badge badge--secondary">Version: v19.0.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Server 3D</h1></header><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Server 3D requires configuring your server to support various features! It is unlikely to work in OSS without significant work. Relay does not claim to fully support Server 3D in OSS (yet), but <a href="/docs/v19.0.0/guides/data-driven-dependencies/client-3d/">Client 3D</a> is fully supported.</p></div></div><p>Use server 3D when all the data fields used to render your 3D components are fetched from GraphQL servers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="simple-3d-with-module">Simple 3D with @module<a href="#simple-3d-with-module" class="hash-link" aria-label="Direct link to Simple 3D with @module" title="Direct link to Simple 3D with @module">â€‹</a></h2><p>The basic case for 3D are the first two cases described in <a href="/docs/v19.0.0/guides/data-driven-dependencies/introduction/#use-cases">Use Cases</a>: content that is typically missing (where the corresponding rendering code is typically unused) or a union of many types (where only some of the possible rendering code is typically used). These cases are supported with the <code>@module(name: String)</code> directive on fragment spreads, which specifies a React component to download only if the data exists and fragment&#x27;s type matches.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-usage-guide">@module Usage Guide<a href="#module-usage-guide" class="hash-link" aria-label="Direct link to @module Usage Guide" title="Direct link to @module Usage Guide">â€‹</a></h3><p>Let&#x27;s walk through how to handle a comment that may contain an image attachment, where we only want to download the image rendering code when an image is actually present.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="server-changes">Server Changes<a href="#server-changes" class="hash-link" aria-label="Direct link to Server Changes" title="Direct link to Server Changes">â€‹</a></h4><ul><li>For each concrete (GraphQLObject) type that you want to use <code>@module</code> with, update the schema to support the fields (<code>__fragment</code> and <code>__component</code>) that are present later in this document.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-changes">Client Changes<a href="#client-changes" class="hash-link" aria-label="Direct link to Client Changes" title="Direct link to Client Changes">â€‹</a></h4><p>Your Relay fragment can now use <code>@module</code>. In this example, if the <code>comment.image</code> field is present (non-null), we load the <code>CommentImage.react</code> component and use the <code>CommentImage_image</code> fragment to load its data.</p><p>On the Relay side you&#x27;d write:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">fragment</span><span class="token plain"> </span><span class="token fragment function" style="color:black">Comment_comment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token object">image</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentImage_image</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token directive function" style="color:black">@module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">name</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentImage.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which the server receives as the following:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">fragment</span><span class="token plain"> </span><span class="token fragment function" style="color:black">Comment_comment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token object">image</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">CommentImage</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentImage_image</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__component</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentImage.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__fragment</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentImage_image$normalization.graphql&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To consume the <code>comment.image</code> field and render the component when the data exists, you shouldn&#x27;t statically require the component (which would introduce a static dependency) and instead use <code>CometRelay.MatchContainer</code> (Comet) or <code>RelayFBMatchContainer</code> (www) to return the dynamically selected component:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">useFragment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> graphql</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token maybe-class-name">MatchContainer</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;react-relay&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* fragment Comment_comment from above */</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Handle cases where the field failed to load or was null</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// MatchContainer may suspend while loading the component or its data,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// consider wrapping with React.Suspense.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">Suspense</span><span class="token plain"> fallback</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MatchContainer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// data for field containing @module selection</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        match</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        props</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* ...other props... */</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token operator" style="color:#b58a5e">/</span><span class="token maybe-class-name">Suspense</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">module</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>When using MatchContainer, the component loaded using 3D needs to have the same prop name as the fragment suffix e.g. if your fragment is <code>Comment_comment</code>, your prop needs to be called <code>comment</code> instead of something like <code>comment$key</code></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-3d-with-match">Advanced 3D with match<a href="#advanced-3d-with-match" class="hash-link" aria-label="Direct link to Advanced 3D with match" title="Direct link to Advanced 3D with match">â€‹</a></h2><p>In some cases a given piece of content can be rendered in a variety of different rendering strategies. In this case, the client and server have to negotiate to choose the ideal strategy for each piece of content: the content may be eligible to be rendered as SuperFancyMarkdown, but if the client doesn&#x27;t support that type the app should fallback to just regular Markdown rather than showing nothing at all. Relay supports this client/server negotiation with the <code>@match</code> directive.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-design-principles">@match Design Principles<a href="#match-design-principles" class="hash-link" aria-label="Direct link to @match Design Principles" title="Direct link to @match Design Principles">â€‹</a></h3><ul><li>The client specifies which strategies it supports (a given client may not support all possible strategies), how it will render that data (one React component per strategy), and what data it needs (a GraphQL fragment for each strategy, describing the React component&#x27;s data dependencies).</li><li>The server - specifically <em>product logic in the schema</em> - selects the rendering strategy to use, selecting the &quot;best&quot; strategy given the user, data, and the client&#x27;s supported strategies.</li><li>The code (Component) and data (GraphQL) for the selected strategy is downloaded <em>dynamically</em> once the strategy is selected. Data is downloaded as normal GraphQL data, and metadata about the code is sent down in a side-channel (technically, in the <code>extensions</code> field of the GraphQL payload).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-usage-guide">@match Usage Guide<a href="#match-usage-guide" class="hash-link" aria-label="Direct link to @match Usage Guide" title="Direct link to @match Usage Guide">â€‹</a></h3><p>Let&#x27;s walk through the steps to implementing the above example of adding a new data-driven dependency for a <code>Comment</code> type with <code>markdown</code> and <code>plaintext</code> rendering strategies.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="server-changes-1">Server Changes<a href="#server-changes-1" class="hash-link" aria-label="Direct link to Server Changes" title="Direct link to Server Changes">â€‹</a></h4><ul><li>Define a new <code>GraphQLUnion</code> type with a variant for each rendering strategy.</li><li>Add a new field on the <code>Comment</code> type that accepts an <code>Array&lt;string&gt; supported</code> argument listing the client&#x27;s supported strategies, and returns one of the union values to indicate the selected strategy.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-changes-1">Client Changes<a href="#client-changes-1" class="hash-link" aria-label="Direct link to Client Changes" title="Direct link to Client Changes">â€‹</a></h4><p>Your Relay fragment can now use <code>@match</code> to specify that for the <code>comment_content_renderer</code> field, we expect dependencies to be decided by the data. In this example, if the <code>comment_content_renderer</code> field is of type <code>CommentMarkdownRenderer</code>, we load the <code>CommentMarkdownRenderer.react</code> component and use the <code>CommentMarkdownRenderer_comment</code> fragment to load its data. Similar for the plaintext variant.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The inline fragments annotated with <code>@module</code> on the same parent 3D fragment must be on distinct concrete types. If they are on the same concrete type, the relay compiler will report an error. So in the example below, <code>CommentMarkdownRenderer_comment</code> must be on a different concrete type than <code>CommentPlaintextRenderer_comment</code> (for example, the former could be on a <code>MarkdownComment</code> type, and the latter on a <code>PlaintextComment</code> type. Both could implement a parent interface <code>Comment</code>).</p></div></div><p>On the Relay side you&#x27;d write:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">fragment</span><span class="token plain"> </span><span class="token fragment function" style="color:black">Comment_comment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token property" style="color:black">comment_content_renderer</span><span class="token plain"> </span><span class="token directive function" style="color:black">@match</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentMarkdownRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token directive function" style="color:black">@module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">name</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentPlaintextRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token directive function" style="color:black">@module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">name</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentPlaintextRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which the server receives as the following - note that the <code>supported</code> argument is generated automatically based on the types that we have provided fragments for above:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">fragment</span><span class="token plain"> </span><span class="token fragment function" style="color:black">Comment_comment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token property-query">comment_content_renderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">supported</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer&quot;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentPlaintextRenderer&quot;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">CommentMarkdownRenderer</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentMarkdownRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__component</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__fragment</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer_comment$normalization.graphql&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">CommentPlaintextRenderer</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentPlaintextRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__component</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentPlaintextRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token attr-name" style="color:#2a6883">__fragment</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token property-query">js</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&quot;CommentPlaintextRenderer_comment$normalization.graphql&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To consume the comment_content_renderer field and render the appropriate container, you shouldn&#x27;t statically require the component (which would introduce a static dependency) and instead use <code>MatchContainer</code> to return the dynamically selected component:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;React&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token maybe-class-name">Suspense</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> useFragment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token maybe-class-name">MatchContainer</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;react-relay&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* fragment from above */</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment_content_renderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Handle cases where the field failed to load or was null</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// MatchContainer may suspend while loading the component/its data,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// consider wrapping with React.Suspense.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">Suspense</span><span class="token plain"> fallback</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MatchContainer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// data for field containing at-module selection</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        match</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment_content_renderer</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        props</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token comment" style="color:#999988;font-style:italic">/* other props */</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token operator" style="color:#b58a5e">/</span><span class="token maybe-class-name">Suspense</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">module</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>When using MatchContainer, the component loaded using 3D needs to have the same prop name as the fragment suffix e.g. if your fragment is <code>Comment_comment</code>, your prop needs to be called <code>comment</code> instead of something like <code>comment$key</code></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-3d-selections-per-fragment">Multiple 3D Selections Per Fragment<a href="#multiple-3d-selections-per-fragment" class="hash-link" aria-label="Direct link to Multiple 3D Selections Per Fragment" title="Direct link to Multiple 3D Selections Per Fragment">â€‹</a></h2><p>If your component needs to select multiple data-driven dependencies in a single fragment, each field must be named with a distinct <code>key</code>. The key can be provided by adding the <code>@match</code> directive on the parent field:</p><div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-graphql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic"># DOESN&#x27;T WORK</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fragment</span><span class="token plain"> </span><span class="token fragment function" style="color:black">Example_comment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token property" style="color:black">comment_content_renderer</span><span class="token plain"> </span><span class="token directive function" style="color:black">@match</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentMarkdownRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token directive function" style="color:black">@module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">name</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token object">attachments</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token object">attachment_renderer</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">...</span><span class="token fragment function" style="color:black">CommentAttachmentPhotoRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token directive function" style="color:black">@module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token attr-name" style="color:#2a6883">name</span><span class="token punctuation" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentPhotoRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will fail with a message such as:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string string" style="color:#65822b">Error: Invalid @module selection: documents with multiple fields containing 3D</span><br></span><span class="token-line" style="color:black"><span class="token template-string string" style="color:#65822b">selections must specify a unique &#x27;key&#x27; value for each field:</span><br></span><span class="token-line" style="color:black"><span class="token template-string string" style="color:#65822b">use &#x27;attachment_renderer @match(key: &quot;ExampleComment_&lt;localName&gt;&quot;)&#x27;.</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this case, follow the suggestion in the error and add <code>@match(key: &quot;...&quot;)</code> on the second 3D field (&#x27;attachment_renderer&#x27; in this case):</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// OK - different keys with @match</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">fragment </span><span class="token maybe-class-name">Example_comment</span><span class="token plain"> on </span><span class="token maybe-class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  comment_content_renderer @match </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token spread operator" style="color:#b58a5e">...</span><span class="token maybe-class-name">CommentMarkdownRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      @</span><span class="token function" style="color:black">module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">name</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentMarkdownRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  attachments </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    attachment_renderer @</span><span class="token function" style="color:black">match</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">key</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;Example_comment__attachment&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token spread operator" style="color:#b58a5e">...</span><span class="token maybe-class-name">CommentAttachmentPhotoRenderer_comment</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        @</span><span class="token function" style="color:black">module</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">name</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;CommentPhotoRenderer.react&quot;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Internally, Relay uses the &#x27;key&#x27; value to isolate the results of each field in the store. This ensures that even if both fields return the same object, that the results can&#x27;t collide.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-with-relay-hooks">Usage with Relay Hooks<a href="#usage-with-relay-hooks" class="hash-link" aria-label="Direct link to Usage with Relay Hooks" title="Direct link to Usage with Relay Hooks">â€‹</a></h2><p>The preferred way of using 3D is with with the <a href="/docs/v19.0.0/api-reference/use-fragment/"><code>useFragment</code></a> API.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// CommentRenderer.react.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> useFragment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token maybe-class-name">MatchContainer</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;react-relay&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">Comment_comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql object">image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">CommentImageRenderer_image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style="color:black">@module</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">name</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;CommentImageRenderer.react&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Handle cases where the field failed to load or was null</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// MatchContainer may suspend while loading the component/its data,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// consider wrapping with React.Suspense.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">Suspense</span><span class="token plain"> fallback</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MatchContainer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// data for field containing @module selection</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        match</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        props</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token spread operator" style="color:#b58a5e">...</span><span class="token plain">other props</span><span class="token spread operator" style="color:#b58a5e">...</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token operator" style="color:#b58a5e">/</span><span class="token maybe-class-name">Suspense</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">module</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div></div><p>The component that is dynamically loaded via 3D can also be a component that uses <code>useFragment</code>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// CommentImageRenderer.react.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> type </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token maybe-class-name">CommentImageRenderer_image$key</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;CommentImageRenderer_image.graphql&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">useFragment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;react-relay&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">type </span><span class="token maybe-class-name">Props</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token literal-property property" style="color:black">image</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token maybe-class-name">CommentImageRenderer_image$key</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentImageRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">CommentImageRenderer_image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql property" style="color:black">src</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token spread operator" style="color:#b58a5e">...</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">module</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">CommentImageRenderer</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-non-react-modules">Using non-React modules<a href="#using-non-react-modules" class="hash-link" aria-label="Direct link to Using non-React modules" title="Direct link to Using non-React modules">â€‹</a></h2><p>The typical usage of data-driven dependencies is to dynamically load modules that export a React component with data-dependencies expressed via Relay. However, Relay also supports dynamically loading <em>arbitrary</em> JS modules. This works the same <code>@match</code> / <code>@module</code> syntax, but (as you may expect) <code>MatchContainer</code> won&#x27;t work for this case. Instead, use <code>ModuleResource.read()</code>. The above example using <code>MatchContainer</code> can be rewritten to manually read and use the <code>@module</code> result:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;React&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token maybe-class-name">Suspense</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> useFragment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token maybe-class-name">ModuleResource</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;react-relay&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">CommentFragment</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">Comment_comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql property" style="color:black">comment_content_renderer</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style="color:black">@match</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">CommentMarkdownRenderer_comment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql directive function" style="color:black">@module</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">name</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;CommentMarkdownRenderer.react&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">CommentPlaintextRenderer_comment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql directive function" style="color:black">@module</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">name</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;CommentPlaintextRenderer.react&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql"></span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">CommentFragment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Handle cases where the field failed to load or was null</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// NOTE: this will suspend if the module is not loaded:</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// the *parent* component should wrap this one in a Suspense boundary</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// MatchedModule will be:</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// - null if there was no match</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// - CommentMarkdownRenderer.react if the result was markdown</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// - CommentPlaintextRenderer.react if the result was plaintext</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">MatchedModule</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ModuleResource</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">read</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token maybe-class-name">MatchedModule</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// no match</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Here we ensure that all possible matched components accept the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// on the same prop key, in this case &#x27;comment&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Note that MatchContainer automatically determines the</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// correct prop key to use for the matched data.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MatchedModule</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      comment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">module</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use <code>@module</code> directly to load a non-React module for a field if it isn&#x27;t null (without using <code>@match</code>), and similarly consume the module using <code>ModuleResource.read()</code>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">Comment_comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql object">image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">CommentImage_image</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql directive function" style="color:black">@module</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">name</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;ImageProcessingModule&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Handle cases where the field failed to load or was null</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// NOTE: this will suspend if the module is not loaded</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">ImageProcessingModule</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ModuleResource</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">read</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">comment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token maybe-class-name">ImageProcessingModule</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// no match</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> <code>@module</code> requires a fragment, which cannot be empty. If you don&#x27;t want to fetch any data from the server (only conditionally files), you can define a &quot;dummy&quot; fragment for your field:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Define a fragment as a wrapper to use with @module</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// The fragment below will be able to reference this fragment by name</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">FragmentForModule_image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string graphql language-graphql property" style="color:black">__typename</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql comment" style="color:#999988;font-style:italic"># only use __typename here since we don&#x27;t need any data</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">  </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql"></span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:black">CommentRenderer</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">useFragment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">fragment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql fragment function" style="color:black">Comment_comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">on</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql class-name">Comment</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql object">image</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql comment" style="color:#999988;font-style:italic"># Spread wrapper fragment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">FragmentForModule_image</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql directive function" style="color:black">@module</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">name</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;ImageProcessingModule&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">    </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">comment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="important-notes--troubleshooting">Important Notes / Troubleshooting<a href="#important-notes--troubleshooting" class="hash-link" aria-label="Direct link to Important Notes / Troubleshooting" title="Direct link to Important Notes / Troubleshooting">â€‹</a></h2><ul><li>Note that <code>MatchContainer</code> will suspend until the selected component finishes loading, so be sure to wrap it in a <code>Suspense</code> placeholder.</li></ul><div class="docsRating" id="docsRating"><hr>Is this page useful?<svg class="i_thumbsup" alt="Like" id="docsRating-like" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"></path></svg><svg class="i_thumbsdown" alt="Dislike" id="docsRating-dislike" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 81.13 89.76"><path d="M22.9 6a18.57 18.57 0 002.67 8.4 25.72 25.72 0 008.65 7.66c3.86 2 8.67 7.13 13.51 11 3.86 3.11 8.57 7.11 11.54 8.45s13.59.26 14.64 1.17c1.88 1.63 1.55 9-.11 15.25-1.61 5.86-5.96 10.55-6.48 16.86-.4 4.83-2.7 4.88-10.93 4.88h-1.35c-3.82 0-8.24 2.93-12.92 3.62a68 68 0 01-9.73.5c-3.57 0-7.86-.08-13.25-.08-3.56 0-4.71-1.83-4.71-4.48h8.42a3.51 3.51 0 000-7H12.28a2.89 2.89 0 01-2.88-2.88 1.91 1.91 0 01.77-1.78h16.46a3.51 3.51 0 000-7H12.29c-3.21 0-4.84-1.83-4.84-4a6.41 6.41 0 011.17-3.78h19.06a3.5 3.5 0 100-7H9.75A3.51 3.51 0 016 42.27a3.45 3.45 0 013.75-3.48h13.11c5.61 0 7.71-3 5.71-5.52-4.43-4.74-10.84-12.62-11-18.71-.15-6.51 2.6-7.83 5.36-8.56m0-6a6.18 6.18 0 00-1.53.2c-6.69 1.77-10 6.65-9.82 14.5.08 5.09 2.99 11.18 8.52 18.09H9.74a9.52 9.52 0 00-6.23 16.9 12.52 12.52 0 00-2.07 6.84 9.64 9.64 0 003.65 7.7 7.85 7.85 0 00-1.7 5.13 8.9 8.9 0 005.3 8.13 6 6 0 00-.26 1.76c0 6.37 4.2 10.48 10.71 10.48h13.25a73.75 73.75 0 0010.6-.56 35.89 35.89 0 007.58-2.18 17.83 17.83 0 014.48-1.34h1.35c4.69 0 7.79 0 10.5-1 3.85-1.44 6-4.59 6.41-9.38.2-2.46 1.42-4.85 2.84-7.62a41.3 41.3 0 003.42-8.13 48 48 0 001.59-10.79c.1-5.13-1-8.48-3.35-10.55-2.16-1.87-4.64-1.87-9.6-1.88a46.86 46.86 0 01-6.64-.29c-1.92-.94-5.72-4-8.51-6.3l-1.58-1.28c-1.6-1.3-3.27-2.79-4.87-4.23-3.33-3-6.47-5.79-9.61-7.45a20.2 20.2 0 01-6.43-5.53 12.44 12.44 0 01-1.72-5.36 6 6 0 00-6-5.86z"></path></svg><p>Help us make the site even better by<!-- --> <a href="https://www.surveymonkey.com/r/FYC9TCJ" target="_blank" rel="noopener noreferrer">answering a few quick questions</a>.</p></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v19.0.0/guides/data-driven-dependencies/server-3d.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#simple-3d-with-module" class="table-of-contents__link toc-highlight">Simple 3D with @module</a><ul><li><a href="#module-usage-guide" class="table-of-contents__link toc-highlight">@module Usage Guide</a></li></ul></li><li><a href="#advanced-3d-with-match" class="table-of-contents__link toc-highlight">Advanced 3D with match</a><ul><li><a href="#match-design-principles" class="table-of-contents__link toc-highlight">@match Design Principles</a></li><li><a href="#match-usage-guide" class="table-of-contents__link toc-highlight">@match Usage Guide</a></li></ul></li><li><a href="#multiple-3d-selections-per-fragment" class="table-of-contents__link toc-highlight">Multiple 3D Selections Per Fragment</a></li><li><a href="#usage-with-relay-hooks" class="table-of-contents__link toc-highlight">Usage with Relay Hooks</a></li><li><a href="#using-non-react-modules" class="table-of-contents__link toc-highlight">Using non-React modules</a></li><li><a href="#important-notes--troubleshooting" class="table-of-contents__link toc-highlight">Important Notes / Troubleshooting</a></li><li><a href="#servercallablemodule-is-no-longer-required" class="table-of-contents__link toc-highlight">ServerCallableModule Is No Longer Required</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/users/">User Showcase</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/relay.svg" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/relay.svg" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright Â© 2025 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.de535efd.js"></script>
<script src="/assets/js/main.509dd6b3.js"></script>
</body>
</html>