"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["63250"],{64568(e,n,r){r.r(n),r.d(n,{metadata:()=>t,default:()=>h,frontMatter:()=>a,contentTitle:()=>l,toc:()=>c,assets:()=>s});var t=JSON.parse('{"id":"api-reference/relay-runtime/relay-environment","title":"Relay Environment","description":"Setting up a Relay Environment","source":"@site/versioned_docs/version-v19.0.0/api-reference/relay-runtime/relay-environment.md","sourceDirName":"api-reference/relay-runtime","slug":"/api-reference/relay-runtime/relay-environment","permalink":"/docs/v19.0.0/api-reference/relay-runtime/relay-environment","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v19.0.0/api-reference/relay-runtime/relay-environment.md","tags":[],"version":"v19.0.0","frontMatter":{"id":"relay-environment","title":"Relay Environment","slug":"/api-reference/relay-runtime/relay-environment","description":"Setting up a Relay Environment"},"sidebar":"docs","previous":{"title":"EntryPointContainer","permalink":"/docs/v19.0.0/api-reference/entrypoint-container/"},"next":{"title":"fetchQuery","permalink":"/docs/v19.0.0/api-reference/fetch-query/"}}'),i=r(74848),o=r(28453);let a={id:"relay-environment",title:"Relay Environment",slug:"/api-reference/relay-runtime/relay-environment",description:"Setting up a Relay Environment"},l,s={},c=[{value:"Creating an Environment",id:"creating-an-environment",level:2},{value:"Advanced Configuration",id:"advanced-configuration",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The core of Relay's runtime is the ",(0,i.jsx)(n.code,{children:"Environment"}),". The environment knows how to make requests to your GraphQL server and contains the ",(0,i.jsx)(n.code,{children:"Store"}),", Relay's normalized data cache. Generally your application will construct a single environment which is configured to fetch data from your server, and then expose that environment to all of your components via ",(0,i.jsx)(n.code,{children:"RelayEnvironmentProvider"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"creating-an-environment",children:"Creating an Environment"}),"\n",(0,i.jsxs)(n.p,{children:["To create your environment you must provide two key pieces, a ",(0,i.jsx)(n.a,{href:"/docs/v19.0.0/guides/network-layer/",children:(0,i.jsx)(n.code,{children:"Network"})})," and a ",(0,i.jsx)(n.a,{href:"/docs/v19.0.0/api-reference/store/",children:(0,i.jsx)(n.code,{children:"Store"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Network"})," is responsible for making requests to your GraphQL server. The ",(0,i.jsx)(n.code,{children:"Store"})," holds the normalized data cache."]}),"\n",(0,i.jsx)(n.p,{children:"A minimal implementation of an environment might look like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="RelayEnvironment.js"',children:'import { Environment, Store, RecordSource, Network, FetchFunction } from "relay-runtime";\n\nconst HTTP_ENDPOINT = "https://graphql.org/graphql/";\n\nconst fetchGraphQL: FetchFunction = async (request, variables) => {\n  const resp = await fetch(HTTP_ENDPOINT, {\n    method: "POST",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ query: request.text, variables }),\n  });\n  if (!resp.ok) {\n    throw new Error("Response failed.");\n  }\n  return await resp.json();\n};\n\nexport const environment = new Environment({\n  store: new Store(new RecordSource({})),\n  network: Network.create(fetchGraphQL),\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,i.jsx)(n.p,{children:"The Relay environment accepts a number of additional configuration options when it is created. These options are all optional, but can be used to customize the behavior of the environment."}),"\n",(0,i.jsx)(n.p,{children:"Notable options include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"log"})," - A function that will be called with telemetry events. See the types for ",(0,i.jsx)(n.a,{href:"https://github.com/facebook/relay/blob/0414c9ad0744483e349e07defcb6d70a52cf8b3c/packages/relay-runtime/store/RelayStoreTypes.js#L799",children:(0,i.jsx)(n.code,{children:"LogEvent"})})," for a full list of events and their fields."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/v19.0.0/guided-tour/reusing-cached-data/filling-in-missing-data/",children:(0,i.jsx)(n.code,{children:"missingFieldHandlers"})})," - A list of handlers that will be called when a field is missing from the store. This can be used to enable fulfilling queries to fields like ",(0,i.jsx)(n.code,{children:"Query.node"})," from cache."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"getDataID"})," - A function that will be called to generate a unique ID for a given object. This can be used to customize the way that Relay generates IDs for objects if your server does not implement the ",(0,i.jsx)(n.a,{href:"https://graphql.org/learn/global-object-identification/",children:"Global Object Identification spec"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/v19.0.0/api-reference/field-logger/",children:(0,i.jsx)(n.code,{children:"relayFieldLogger"})})," - A function that will be called when Relay encounters a field-level error."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For a full list of options, inspect the ",(0,i.jsx)(n.a,{href:"https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/relay-runtime/lib/store/RelayModernEnvironment.d.ts#L26-L43",children:"provided TypeScript types"}),"."]})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453(e,n,r){r.d(n,{R:()=>a,x:()=>l});var t=r(96540);let i={},o=t.createContext(i);function a(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);