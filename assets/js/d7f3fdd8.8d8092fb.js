"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["53616"],{68627(e,n,r){r.r(n),r.d(n,{metadata:()=>t,default:()=>u,frontMatter:()=>a,contentTitle:()=>o,toc:()=>d,assets:()=>l});var t=JSON.parse('{"id":"api-reference/relay-resolvers/runtime-functions","title":"Runtime Functions","description":"Runtime functions associated with Relay Resolvers","source":"@site/versioned_docs/version-v19.0.0/api-reference/relay-resolvers/runtime-functions.md","sourceDirName":"api-reference/relay-resolvers","slug":"/api-reference/relay-resolvers/runtime-functions/","permalink":"/docs/v19.0.0/api-reference/relay-resolvers/runtime-functions/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v19.0.0/api-reference/relay-resolvers/runtime-functions.md","tags":[],"version":"v19.0.0","frontMatter":{"id":"runtime-functions","title":"Runtime Functions","slug":"/api-reference/relay-resolvers/runtime-functions/","description":"Runtime functions associated with Relay Resolvers"},"sidebar":"docs","previous":{"title":"Docblock Format","permalink":"/docs/v19.0.0/api-reference/relay-resolvers/docblock-format/"},"next":{"title":"GraphQL Directives","permalink":"/docs/v19.0.0/api-reference/graphql-and-directives/"}}'),s=r(74848),i=r(28453);let a={id:"runtime-functions",title:"Runtime Functions",slug:"/api-reference/relay-resolvers/runtime-functions/",description:"Runtime functions associated with Relay Resolvers"},o,l={},d=[{value:"RelayModernStore",id:"relaymodernstore",level:2},{value:"<code>readFragment()</code>",id:"readfragment",level:2},{value:"<code>suspenseSentinel()</code>",id:"suspensesentinel",level:2},{value:"<code>useClientQuery()</code>",id:"useclientquery",level:2}];function c(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["This page documents the runtime functions associated with Relay Resolvers. For an overview of Relay Resolvers and how to think about them, see the ",(0,s.jsx)(n.a,{href:"/docs/v19.0.0/guides/relay-resolvers/introduction",children:"Relay Resolvers"})," guide."]}),"\n",(0,s.jsx)(n.h2,{id:"relaymodernstore",children:"RelayModernStore"}),"\n",(0,s.jsxs)(n.p,{children:["RelayModernStore exposes ",(0,s.jsx)(n.code,{children:"batchLiveStateUpdates()"}),". See ",(0,s.jsx)(n.a,{href:"/docs/v19.0.0/guides/relay-resolvers/live-fields/#batching",children:"Live Fields"})," for more details of how to use this method."]}),"\n",(0,s.jsx)(n.h2,{id:"readfragment",children:(0,s.jsx)(n.code,{children:"readFragment()"})}),"\n",(0,s.jsxs)(n.p,{children:["Derived resolver fields model data that is derived from other data in the graph. To read the data that a derived field depends on, they must use the ",(0,s.jsx)(n.code,{children:"readFragment()"})," function which is exported from ",(0,s.jsx)(n.code,{children:"relay-runtime"}),". This function accepts a GraphQL fragment and a fragment key, and returns the data for the fragment."]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"readFragment()"})," may only be used in Relay Resolvers. It will throw an error if used in any other context."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'import {readFragment} from "relay-runtime";\n\n/**\n * @RelayResolver User.fullName: String\n * @rootFragment UserFullNameFragment\n */\nexport function fullName(key: UserFullNameFragment$key): string {\n  const user = readFragment(graphql`\n    fragment UserFullNameFragment on User {\n      firstName\n      lastName\n    }\n  `, key);\n  return `${user.firstName} ${user.lastName}`;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Note that Relay will ensure your field resolver is recomputed any time data in that fragment changes."}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/docs/v19.0.0/guides/relay-resolvers/derived-fields/",children:"Derived Fields"})," guide for more information."]}),"\n",(0,s.jsx)(n.h2,{id:"suspensesentinel",children:(0,s.jsx)(n.code,{children:"suspenseSentinel()"})}),"\n",(0,s.jsxs)(n.p,{children:["Live resolvers model client state that can change over time. If at some point during that field's lifecycle, the data being read is in a pending state, for example if the data is being fetched from an API, the resolver may return the ",(0,s.jsx)(n.code,{children:"suspenseSentinel()"})," to indicate that the data is not yet available."]}),"\n",(0,s.jsxs)(n.p,{children:["Relay expects that when the data is available, the ",(0,s.jsx)(n.code,{children:"LiveStateValue"})," will notify Relay by calling the subscribe callback."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {suspenseSentinel} from 'relay-runtime';\n\n/**\n * @RelayResolver Query.myIp: String\n * @live\n */\nexport function myIp(): LiveState<string> {\n  return {\n    read: () => {\n      const state = store.getState();\n      const ipLoadObject = state.ip;\n      if (ipLoadObject.status === \"LOADING\") {\n        return suspenseSentinel();\n      }\n      return state.ip;\n    },\n    subscribe: (callback) => {\n      return store.subscribe(callback);\n    },\n  };\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/docs/v19.0.0/guides/relay-resolvers/live-fields/",children:"Live Fields"})," guide for more information."]}),"\n",(0,s.jsx)(n.h2,{id:"useclientquery",children:(0,s.jsx)(n.code,{children:"useClientQuery()"})}),"\n",(0,s.jsxs)(n.p,{children:["If a query contains only client fields, it may not currently be used with hooks like ",(0,s.jsx)(n.code,{children:"usePreloadedQuery"})," and ",(0,s.jsx)(n.code,{children:"useLazyLoadQuery"})," since both of those hooks assume they will need to issue a network request. If you attempt to use these APIs in Flow you will get a type error."]}),"\n",(0,s.jsxs)(n.p,{children:["Instead, for client-only queries, you can use the ",(0,s.jsx)(n.code,{children:"useClientQuery"})," hook:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import {useClientQuery} from 'react-relay';\n\nexport function MyComponent() {\n  const data = useClientQuery(graphql`\n    query MyQuery {\n      myIp\n    }\n  `);\n  return <div>{data.myIp}</div>;\n}\n"})})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453(e,n,r){r.d(n,{R:()=>a,x:()=>o});var t=r(96540);let s={},i=t.createContext(s);function a(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);