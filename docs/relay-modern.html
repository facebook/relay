<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Introduction to Relay Modern - Relay Docs</title><meta name="viewport" content="width=device-width"><meta property="og:title" content="Introduction to Relay Modern - Relay Docs"><meta property="og:type" content="website"><meta property="og:url" content="http://facebook.github.io/relay/"><meta property="og:description" content="A JavaScript framework for building data-driven React applications"><link rel="shortcut icon" href="/relay/img/favicon.png"><link rel="stylesheet" href="/relay/css/relay.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/relay/"><img class="nav-logo" src="/relay/img/logo.svg" width="50" height="50">Relay</a><ul class="nav-site"><li><a href="/relay/prototyping/playground.html" class="">Try it out</a></li><li><a href="/relay/docs/getting-started.html" class="active">Docs</a></li><li><a href="/relay/support.html" class="">Support</a></li><li><a href="https://github.com/facebook/relay" class="">GitHub</a></li></ul></div></div><section class="content wrap documentationContent"><div class="inner-content"><a id="content"></a><h1>Introduction to Relay Modern</h1><div><p>Relay Modern is a new version of Relay designed from the ground up to be easier to use, more extensible and, most of all, able to improve performance on mobile devices. Relay Modern accomplishes this with static queries and ahead-of-time code generation.</p><h2><a class="anchor" name="getting-started"></a>Getting Started <a class="hash-link" href="#getting-started">#</a></h2><h3><a class="anchor" name="upgrade-to-react-relay-v1-0-0"></a>Upgrade to react-relay v1.0.0 <a class="hash-link" href="#upgrade-to-react-relay-v1-0-0">#</a></h3><p>Relay v1.0 introduces the Relay Modern API:</p><pre class="prism language-javascript">
yarn add react<span class="token operator">-</span>relay</pre><p>When upgrading an existing Relay app, replace all <code>require(&#x27;react-relay&#x27;)</code> with <code>require(&#x27;react-relay/classic&#x27;)</code> to continue to import the Relay Classic API.</p><h3><a class="anchor" name="set-up-babel-plugin-relay"></a>Set up babel-plugin-relay <a class="hash-link" href="#set-up-babel-plugin-relay">#</a></h3><p>Relay Modern requires a Babel plugin to convert GraphQL to runtime artifacts:</p><pre class="prism language-javascript">
yarn add <span class="token operator">--</span>dev babel<span class="token operator">-</span>plugin<span class="token operator">-</span>relay</pre><p>Add <code>&quot;relay&quot;</code> to the list of plugins your .babelrc file. See <a href="./babel-plugin-relay.html" target="_blank">the docs</a> if upgrading an existing Relay app.</p><h3><a class="anchor" name="set-up-relay-compiler"></a>Set up relay-compiler <a class="hash-link" href="#set-up-relay-compiler">#</a></h3><p>Relay Modern&#x27;s ahead-of-time compilation requires the new Relay Compiler:</p><pre class="prism language-javascript">
yarn add <span class="token operator">--</span>dev relay<span class="token operator">-</span>compiler</pre><p>Run the Relay Compiler after making changes to any GraphQL in your Relay application. It may be helpful to add it as a <code>yarn script</code>. Add an entry to <code>&quot;scripts&quot;</code> in your package.json file.</p><pre class="prism language-javascript">
<span class="token string">&quot;relay&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;relay-compiler --src ./src --schema path/schema.graphql&quot;</span></pre><p>Then after making edits to your application files, just run <code>yarn run relay</code> to generate new files, or <code>yarn run relay -- --watch</code> to run the compiler as a long-lived process which automatically generates new files whenever you save.</p><h2><a class="anchor" name="migrating-to-relay-modern"></a>Migrating to Relay Modern <a class="hash-link" href="#migrating-to-relay-modern">#</a></h2><p>Migrating a Relay Classic app to Relay Modern doesn&#x27;t require rewriting from
scratch. Instead, you can convert one component at a time to the Relay Modern API while
continuing to have a working app. Once all components have been converted, the
smaller and faster Relay Modern runtime can be used.</p><p>During this migration, use the <a href="./relay-compat.html" target="_blank">Relay Compat</a> tools and APIs to work with both Relay Classic and Relay Modern.</p><h2><a class="anchor" name="idea"></a>Idea <a class="hash-link" href="#idea">#</a></h2><p><a href="https://facebook.github.io/react/" target="_blank">React</a> allows views to be defined as components where every component is responsible for rendering a part of the UI. Composing other components is how to build complex UIs. Each React component doesn&#x27;t need to know the inner workings of the composed components.</p><p>Relay couples React with GraphQL and develops the idea of encapsulation further. It allows components to specify what data they need and the Relay framework provides the data. This makes the data needs of inner components opaque and allows composition of those needs. Thinking about what data an app needs becomes localized to the component making it easier to reason about what fields are needed or no longer needed.</p><h2><a class="anchor" name="terminology"></a>Terminology <a class="hash-link" href="#terminology">#</a></h2><h3><a class="anchor" name="container"></a>Container <a class="hash-link" href="#container">#</a></h3><p>Relay Modern containers combine standard React components with a description of their data requirements, expressed as one or more GraphQL fragments. Each container is itself a standard React component that can be rendered using the standard React API (e.g. <code>&lt;YourComponent prop={...} /&gt;</code>). When rendered, a container will read the data for its fragment from the Relay cache. As the fragment data changes - for example due to a mutation, subscription, or updated query response - the container will automatically re-render the component.</p><p><a href="./fragment-container.html" target="_blank"><code>createFragmentContainer</code></a> returns a basic container that cannot fetch additional data beyond what is declared in its fragment(s). Relay Modern also provides more advanced containers for dynamic use cases (which were previously handled in Relay Classic via <code>setVariables</code>):</p><h4><a class="anchor" name="container-refetching-data-aka-see-more"></a>Refetching Data (aka &quot;See More&quot;) <a class="hash-link" href="#container-refetching-data-aka-see-more">#</a></h4><p><a href="./refetch-container.html" target="_blank"><code>createRefetchContainer</code></a> is a variation of <code>createFragmentContainer</code> that addresses the &quot;see more&quot; use case, where a subset of data is rendered initially and then additional data is fetched on demand. Refetch containers initially fetch data for their fragments just like fragment containers, but also offer a <code>refetch()</code> method by which additional data can be fetched, or the container can be re-rendered to read data using different variables.</p><h3><a class="anchor" name="pagination-container"></a>Pagination Container <a class="hash-link" href="#pagination-container">#</a></h3><p>This is a specialization of the general-purpose refetch container that is tailored for the common scenario of paginating through a collection of items by fetching successively more pages of data. See <a href="./pagination-container.html" target="_blank"><code>createPaginationContainer</code></a> for details.</p><h3><a class="anchor" name="query-renderer"></a>Query Renderer <a class="hash-link" href="#query-renderer">#</a></h3><p><a href="./query-renderer.html" target="_blank"><code>QueryRenderer</code></a> manages the execution of the GraphQL query. It sends the query with given variables, parses the response, saves the data to the internal cache, and finally renders the view.</p><h3><a class="anchor" name="relay-environment"></a>Relay Environment <a class="hash-link" href="#relay-environment">#</a></h3><p>An instance of a <a href="./relay-environment.html" target="_blank">Relay Environment</a> encapsulates an in-memory cache of GraphQL data and a network layer that provides access to your GraphQL server. The Environment object is typically not used by developers directly, instead it is passed to each <a href="./query-renderer.html" target="_blank"><code>QueryRenderer</code></a>, which uses the environment to access, modify, and fetch data. Within a container, the current environment can be accessed via <code>this.props.relay.environment</code>. This is most commonly used to <a href="./mutations.html" target="_blank">execute a mutation</a>.</p><h3><a class="anchor" name="network-layer"></a>Network layer <a class="hash-link" href="#network-layer">#</a></h3><p>Applications must supply a <a href="./network-layer.html" target="_blank">Network Layer</a> when creating an instance of a Relay Environment. The network layer is an object conforming to a simple interface through which Relay can execute queries, mutations, and subscriptions. Essentially, this object teaches Relay how to talk to your GraphQL server.</p><h2><a class="anchor" name="workflow"></a>Workflow <a class="hash-link" href="#workflow">#</a></h2><p>One of the big ideas behind the new API is that execution can be made a lot more efficient by moving work ahead-of-time: from the runtime of the app to the build-time. As such, changes to GraphQL fragments require a build step to regenerate a set of artifacts. More on <a href="./relay-compiler.html" target="_blank">the Relay Compiler</a>.</p><h2><a class="anchor" name="comparing-relay-classic-and-relay-modern"></a>Comparing Relay Classic and Relay Modern <a class="hash-link" href="#comparing-relay-classic-and-relay-modern">#</a></h2><p>Relay Modern enables a variety of new features. Some are available via the Compat API, while others require upgrading fully to the Modern runtime. See <a href="./new-in-relay-modern.html" target="_blank">what&#x27;s new in Relay Modern</a> for more details.</p></div><div class="docs-prevnext"><a class="docs-next" href="new-in-relay-modern.html">Next →</a></div></div><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/getting-started.html">Getting Started</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/tutorial.html">Tutorial</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/thinking-in-graphql.html">Thinking in GraphQL</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/thinking-in-relay.html">Thinking In Relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/videos.html">Videos</a></li></ul></div><div class="nav-docs-section"><h3>Relay Modern</h3><ul><li><a style="margin-left:0;" class="active" href="/relay/docs/relay-modern.html">Introduction to Relay Modern</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/new-in-relay-modern.html">New in Relay Modern</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/relay-environment.html">The Relay &quot;Environment&quot;</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/network-layer.html">The Relay Network Layer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/query-renderer.html">QueryRenderer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/fragment-container.html">FragmentContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/refetch-container.html">RefetchContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/pagination-container.html">PaginationContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/routing.html">Routing</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/subscriptions.html">Subscriptions</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/babel-plugin-relay.html">babel-plugin-relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/relay-compiler.html">Relay Compiler</a></li></ul></div><div class="nav-docs-section"><h3>Relay Compat</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/relay-compat.html">Compatibility Mode</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/conversion-playbook.html">Conversion Playbook</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/conversion-scripts.html">Conversion Scripts</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/upgrading-setvariables.html">Upgrading setVariables</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/compatibility-cheatsheet.html">Compatibility Cheatsheet</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-cheatsheet.html">API Cheatsheet</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic Guides</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/guides-containers.html">Containers</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-routes.html">Routes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-root-container.html">Root Container</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-ready-state.html">Ready State</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-network-layer.html">Network Layer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/guides-babel-plugin.html">Babel Relay Plugin</a></li></ul></div><div class="nav-docs-section"><h3>GraphQL</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-relay-specification.html">GraphQL Relay Specification</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-object-identification.html">Object Identification</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-connections.html">Connection</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-mutations.html">Mutations</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/graphql-further-reading.html">Further Reading</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic API</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay.html">Relay</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-container.html">RelayContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-route.html">Relay.Route</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-renderer.html">Relay.Renderer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-root-container.html">Relay.RootContainer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-ql.html">Relay.QL</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-mutation.html">Relay.Mutation</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-graphql-mutation.html">Relay.GraphQLMutation</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-proptypes.html">Relay.PropTypes</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/api-reference-relay-store.html">Relay.Store</a></li></ul></div><div class="nav-docs-section"><h3>Relay Classic Interfaces</h3><ul><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-network-layer.html">RelayNetworkLayer</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-mutation-request.html">RelayMutationRequest</a></li><li><a style="margin-left:0;" class="" href="/relay/docs/interfaces-relay-query-request.html">RelayQueryRequest</a></li></ul></div></div></section><footer><span><a class="edit-page-link" href="https://github.com/facebook/relay/blob/master/docs/Introduction.md" target="_blank">Edit This Page</a></span><span>Copyright © 2017 Facebook Inc</span></footer></div><div id="fb-root"></div><script>
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
              ga('create', 'UA-71174216-1', 'auto');
              ga('send', 'pageview');
          </script></body></html>